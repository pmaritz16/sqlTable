var Ml=Object.defineProperty;var Dl=(l,t,n)=>t in l?Ml(l,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[t]=n;var We=(l,t,n)=>Dl(l,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const u of s)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function n(s){const u={};return s.integrity&&(u.integrity=s.integrity),s.referrerPolicy&&(u.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?u.credentials="include":s.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(s){if(s.ep)return;s.ep=!0;const u=n(s);fetch(s.href,u)}})();function ge(){}function jr(l){return l()}function $n(){return Object.create(null)}function Me(l){l.forEach(jr)}function Vr(l){return typeof l=="function"}function $e(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}function Il(l){return Object.keys(l).length===0}const Ol=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function h(l,t){l.appendChild(t)}function Q(l,t,n){l.insertBefore(t,n||null)}function U(l){l.parentNode&&l.parentNode.removeChild(l)}function ft(l,t){for(let n=0;n<l.length;n+=1)l[n]&&l[n].d(t)}function E(l){return document.createElement(l)}function V(l){return document.createTextNode(l)}function F(){return V(" ")}function gn(){return V("")}function me(l,t,n,o){return l.addEventListener(t,n,o),()=>l.removeEventListener(t,n,o)}function Fl(l){return function(t){return t.preventDefault(),l.call(this,t)}}function zl(l){return function(t){return t.stopPropagation(),l.call(this,t)}}function v(l,t,n){n==null?l.removeAttribute(t):l.getAttribute(t)!==n&&l.setAttribute(t,n)}function jl(l){let t;return{p(...n){t=n,t.forEach(o=>l.push(o))},r(){t.forEach(n=>l.splice(l.indexOf(n),1))}}}function Vl(l){return Array.from(l.childNodes)}function fe(l,t){t=""+t,l.data!==t&&(l.data=t)}function ct(l,t){l.value=t??""}function Ul(l,t,n,o){l.style.setProperty(t,n,"")}function Bt(l,t,n){for(let o=0;o<l.options.length;o+=1){const s=l.options[o];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function vt(l,t,n){l.classList.toggle(t,!!n)}function Ql(l,t,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(l,{detail:t,bubbles:n,cancelable:o})}let Lt;function Pt(l){Lt=l}function Ur(){if(!Lt)throw new Error("Function called outside component initialization");return Lt}function Qr(l){Ur().$$.on_mount.push(l)}function yt(){const l=Ur();return(t,n,{cancelable:o=!1}={})=>{const s=l.$$.callbacks[t];if(s){const u=Ql(t,n,{cancelable:o});return s.slice().forEach(f=>{f.call(l,u)}),!u.defaultPrevented}return!0}}function Bl(l,t){const n=l.$$.callbacks[t.type];n&&n.slice().forEach(o=>o.call(this,t))}const _t=[],xn=[];let wt=[];const er=[],Wl=Promise.resolve();let dn=!1;function Gl(){dn||(dn=!0,Wl.then(Br))}function hn(l){wt.push(l)}const cn=new Set;let gt=0;function Br(){if(gt!==0)return;const l=Lt;do{try{for(;gt<_t.length;){const t=_t[gt];gt++,Pt(t),Hl(t.$$)}}catch(t){throw _t.length=0,gt=0,t}for(Pt(null),_t.length=0,gt=0;xn.length;)xn.pop()();for(let t=0;t<wt.length;t+=1){const n=wt[t];cn.has(n)||(cn.add(n),n())}wt.length=0}while(_t.length);for(;er.length;)er.pop()();dn=!1,cn.clear(),Pt(l)}function Hl(l){if(l.fragment!==null){l.update(),Me(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(hn)}}function Xl(l){const t=[],n=[];wt.forEach(o=>l.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),wt=t}const Qt=new Set;let ut;function mn(){ut={r:0,c:[],p:ut}}function pn(){ut.r||Me(ut.c),ut=ut.p}function Ae(l,t){l&&l.i&&(Qt.delete(l),l.i(t))}function Oe(l,t,n,o){if(l&&l.o){if(Qt.has(l))return;Qt.add(l),ut.c.push(()=>{Qt.delete(l),o&&(n&&l.d(1),o())}),l.o(t)}else o&&o()}function Pe(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function Jl(l,t){l.d(1),t.delete(l.key)}function Yl(l,t,n,o,s,u,f,d,m,a,p,g){let w=l.length,S=u.length,C=w;const _={};for(;C--;)_[l[C].key]=C;const y=[],P=new Map,D=new Map,$=[];for(C=S;C--;){const I=g(s,u,C),H=n(I);let A=f.get(H);A?$.push(()=>A.p(I,t)):(A=a(H,I),A.c()),P.set(H,y[C]=A),H in _&&D.set(H,Math.abs(C-_[H]))}const B=new Set,re=new Set;function W(I){Ae(I,1),I.m(d,p),f.set(I.key,I),p=I.first,S--}for(;w&&S;){const I=y[S-1],H=l[w-1],A=I.key,z=H.key;I===H?(p=I.first,w--,S--):P.has(z)?!f.has(A)||B.has(A)?W(I):re.has(z)?w--:D.get(A)>D.get(z)?(re.add(A),W(I)):(B.add(z),w--):(m(H,f),w--)}for(;w--;){const I=l[w];P.has(I.key)||m(I,f)}for(;S;)W(y[S-1]);return Me($),y}function dt(l){l&&l.c()}function xe(l,t,n){const{fragment:o,after_update:s}=l.$$;o&&o.m(t,n),hn(()=>{const u=l.$$.on_mount.map(jr).filter(Vr);l.$$.on_destroy?l.$$.on_destroy.push(...u):Me(u),l.$$.on_mount=[]}),s.forEach(hn)}function et(l,t){const n=l.$$;n.fragment!==null&&(Xl(n.after_update),Me(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Kl(l,t){l.$$.dirty[0]===-1&&(_t.push(l),Gl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function tt(l,t,n,o,s,u,f=null,d=[-1]){const m=Lt;Pt(l);const a=l.$$={fragment:null,ctx:[],props:u,update:ge,not_equal:s,bound:$n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:$n(),dirty:d,skip_bound:!1,root:t.target||m.$$.root};f&&f(a.root);let p=!1;if(a.ctx=n?n(l,t.props||{},(g,w,...S)=>{const C=S.length?S[0]:w;return a.ctx&&s(a.ctx[g],a.ctx[g]=C)&&(!a.skip_bound&&a.bound[g]&&a.bound[g](C),p&&Kl(l,g)),w}):[],a.update(),p=!0,Me(a.before_update),a.fragment=o?o(a.ctx):!1,t.target){if(t.hydrate){const g=Vl(t.target);a.fragment&&a.fragment.l(g),g.forEach(U)}else a.fragment&&a.fragment.c();t.intro&&Ae(l.$$.fragment),xe(l,t.target,t.anchor),Br()}Pt(m)}class nt{constructor(){We(this,"$$");We(this,"$$set")}$destroy(){et(this,1),this.$destroy=ge}$on(t,n){if(!Vr(n))return ge;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const s=o.indexOf(n);s!==-1&&o.splice(s,1)}}$set(t){this.$$set&&!Il(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Zl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Zl);class $l{constructor(t){this.api=t,this.defaultConfigPath=null,this.defaultConfig={databasePath:"",csvFiles:[]}}async initialize(){this.defaultConfigPath=await this.api.getDefaultConfigPath();const t=await this.api.getDefaultDatabasePath();this.defaultConfig.databasePath=t}getDefaultConfigPath(){return this.defaultConfigPath}async createDefaultConfig(){try{return await this.api.createDefaultConfig(this.defaultConfig)}catch(t){return console.error("Error creating default config:",t),!1}}async loadConfig(t){try{return await this.api.loadConfig(t)}catch(n){return console.error("Error loading config:",n),null}}async saveConfig(t,n){try{return await this.api.saveConfig(t,n),!0}catch(o){return console.error("Error saving config:",o),!1}}validateConfig(t){return!(!t||!t.databasePath||!Array.isArray(t.csvFiles))}async selectConfigFile(){try{return await this.api.selectConfigFile({title:"Select Config File",filters:[{name:"JSON",extensions:["json"]}]})}catch(t){return console.error("Error selecting config file:",t),null}}async readConfigFileRaw(t){try{return await this.api.readConfigFileRaw(t)}catch(n){return console.error("Error reading config file raw:",n),null}}}function xl(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function eo(l){if(l.__esModule)return l;var t=l.default;if(typeof t=="function"){var n=function o(){return this instanceof o?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(l).forEach(function(o){var s=Object.getOwnPropertyDescriptor(l,o);Object.defineProperty(n,o,s.get?s:{enumerable:!0,get:function(){return l[o]}})}),n}var Wr={exports:{}};const to={},no=Object.freeze(Object.defineProperty({__proto__:null,default:to},Symbol.toStringTag,{value:"Module"})),tr=eo(no);(function(l,t){var n=void 0,o=function(s){return n||(n=new Promise(function(u,f){var d=typeof s<"u"?s:{},m=d.onAbort;d.onAbort=function(e){f(new Error(e)),m&&m(e)},d.postRun=d.postRun||[],d.postRun.push(function(){u(d)}),l=void 0;var a;a||(a=typeof d<"u"?d:{});var p=typeof window=="object",g=typeof WorkerGlobalScope<"u",w=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";a.onRuntimeInitialized=function(){function e(k,L){switch(typeof L){case"boolean":Nl(k,L?1:0);break;case"number":Al(k,L);break;case"string":Pl(k,L,-1,-1);break;case"object":if(L===null)Jn(k);else if(L.length!=null){var G=jt(L,zt);Ll(k,G,L.length,-1),Vt(G)}else Ut(k,"Wrong API use : tried to return a value of an unknown type ("+L+").",-1);break;default:Jn(k)}}function r(k,L){for(var G=[],ee=0;ee<k;ee+=1){var ie=ne(L+4*ee,"i32"),be=kl(ie);if(be===1||be===2)ie=ql(ie);else if(be===3)ie=Sl(ie);else if(be===4){be=ie,ie=Tl(be),be=Cl(be);for(var Ve=new Uint8Array(ie),ze=0;ze<ie;ze+=1)Ve[ze]=z[be+ze];ie=Ve}else ie=null;G.push(ie)}return G}function i(k,L){this.Qa=k,this.db=L,this.Oa=1,this.lb=[]}function c(k,L){if(this.db=L,L=kt(k)+1,this.eb=an(L),this.eb===null)throw Error("Unable to allocate memory for the SQL string");Ge(k,M,this.eb,L),this.kb=this.eb,this.Za=this.pb=null}function b(k){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),k!=null){var L=this.filename,G="/",ee=L;if(G&&(G=typeof G=="string"?G:Yt(G),ee=L?rt(G+"/"+L):G),L=yn(!0,!0),ee=xr(ee,L),k){if(typeof k=="string"){G=Array(k.length);for(var ie=0,be=k.length;ie<be;++ie)G[ie]=k.charCodeAt(ie);k=G}Dt(ee,L|146),G=bt(ee,577),zn(G,k,0,k.length,0),tn(G),Dt(ee,L)}}this.handleError(Y(this.filename,T)),this.db=ne(T,"i32"),Kn(this.db),this.fb={},this.Sa={}}var T=Ze(4),q=a.cwrap,Y=q("sqlite3_open","number",["string","number"]),he=q("sqlite3_close_v2","number",["number"]),de=q("sqlite3_exec","number",["number","string","number","number","number"]),ke=q("sqlite3_changes","number",["number"]),Re=q("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Bn=q("sqlite3_sql","string",["number"]),il=q("sqlite3_normalized_sql","string",["number"]),Wn=q("sqlite3_prepare_v2","number",["number","number","number","number","number"]),sl=q("sqlite3_bind_text","number",["number","number","number","number","number"]),Gn=q("sqlite3_bind_blob","number",["number","number","number","number","number"]),al=q("sqlite3_bind_double","number",["number","number","number"]),ul=q("sqlite3_bind_int","number",["number","number","number"]),fl=q("sqlite3_bind_parameter_index","number",["number","string"]),cl=q("sqlite3_step","number",["number"]),dl=q("sqlite3_errmsg","string",["number"]),hl=q("sqlite3_column_count","number",["number"]),ml=q("sqlite3_data_count","number",["number"]),pl=q("sqlite3_column_double","number",["number","number"]),Hn=q("sqlite3_column_text","string",["number","number"]),bl=q("sqlite3_column_blob","number",["number","number"]),gl=q("sqlite3_column_bytes","number",["number","number"]),_l=q("sqlite3_column_type","number",["number","number"]),wl=q("sqlite3_column_name","string",["number","number"]),vl=q("sqlite3_reset","number",["number"]),yl=q("sqlite3_clear_bindings","number",["number"]),El=q("sqlite3_finalize","number",["number"]),Xn=q("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),kl=q("sqlite3_value_type","number",["number"]),Tl=q("sqlite3_value_bytes","number",["number"]),Sl=q("sqlite3_value_text","string",["number"]),Cl=q("sqlite3_value_blob","number",["number"]),ql=q("sqlite3_value_double","number",["number"]),Al=q("sqlite3_result_double","",["number","number"]),Jn=q("sqlite3_result_null","",["number"]),Pl=q("sqlite3_result_text","",["number","string","number","number"]),Ll=q("sqlite3_result_blob","",["number","number","number","number"]),Nl=q("sqlite3_result_int","",["number","number"]),Ut=q("sqlite3_result_error","",["number","string","number"]),Yn=q("sqlite3_aggregate_context","number",["number","number"]),Kn=q("RegisterExtensionFunctions","number",["number"]),Zn=q("sqlite3_update_hook","number",["number","number","number"]);i.prototype.bind=function(k){if(!this.Qa)throw"Statement closed";return this.reset(),Array.isArray(k)?this.Cb(k):k!=null&&typeof k=="object"?this.Db(k):!0},i.prototype.step=function(){if(!this.Qa)throw"Statement closed";this.Oa=1;var k=cl(this.Qa);switch(k){case 100:return!0;case 101:return!1;default:throw this.db.handleError(k)}},i.prototype.wb=function(k){return k==null&&(k=this.Oa,this.Oa+=1),pl(this.Qa,k)},i.prototype.Gb=function(k){if(k==null&&(k=this.Oa,this.Oa+=1),k=Hn(this.Qa,k),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(k)},i.prototype.Hb=function(k){return k==null&&(k=this.Oa,this.Oa+=1),Hn(this.Qa,k)},i.prototype.getBlob=function(k){k==null&&(k=this.Oa,this.Oa+=1);var L=gl(this.Qa,k);k=bl(this.Qa,k);for(var G=new Uint8Array(L),ee=0;ee<L;ee+=1)G[ee]=z[k+ee];return G},i.prototype.get=function(k,L){L=L||{},k!=null&&this.bind(k)&&this.step(),k=[];for(var G=ml(this.Qa),ee=0;ee<G;ee+=1)switch(_l(this.Qa,ee)){case 1:var ie=L.useBigInt?this.Gb(ee):this.wb(ee);k.push(ie);break;case 2:k.push(this.wb(ee));break;case 3:k.push(this.Hb(ee));break;case 4:k.push(this.getBlob(ee));break;default:k.push(null)}return k},i.prototype.getColumnNames=function(){for(var k=[],L=hl(this.Qa),G=0;G<L;G+=1)k.push(wl(this.Qa,G));return k},i.prototype.getAsObject=function(k,L){k=this.get(k,L),L=this.getColumnNames();for(var G={},ee=0;ee<L.length;ee+=1)G[L[ee]]=k[ee];return G},i.prototype.getSQL=function(){return Bn(this.Qa)},i.prototype.getNormalizedSQL=function(){return il(this.Qa)},i.prototype.run=function(k){return k!=null&&this.bind(k),this.step(),this.reset()},i.prototype.sb=function(k,L){L==null&&(L=this.Oa,this.Oa+=1),k=_n(k);var G=jt(k,zt);this.lb.push(G),this.db.handleError(sl(this.Qa,L,G,k.length-1,0))},i.prototype.Bb=function(k,L){L==null&&(L=this.Oa,this.Oa+=1);var G=jt(k,zt);this.lb.push(G),this.db.handleError(Gn(this.Qa,L,G,k.length,0))},i.prototype.rb=function(k,L){L==null&&(L=this.Oa,this.Oa+=1),this.db.handleError((k===(k|0)?ul:al)(this.Qa,L,k))},i.prototype.Eb=function(k){k==null&&(k=this.Oa,this.Oa+=1),Gn(this.Qa,k,0,0,0)},i.prototype.tb=function(k,L){switch(L==null&&(L=this.Oa,this.Oa+=1),typeof k){case"string":this.sb(k,L);return;case"number":this.rb(k,L);return;case"bigint":this.sb(k.toString(),L);return;case"boolean":this.rb(k+0,L);return;case"object":if(k===null){this.Eb(L);return}if(k.length!=null){this.Bb(k,L);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+k+")."},i.prototype.Db=function(k){var L=this;return Object.keys(k).forEach(function(G){var ee=fl(L.Qa,G);ee!==0&&L.tb(k[G],ee)}),!0},i.prototype.Cb=function(k){for(var L=0;L<k.length;L+=1)this.tb(k[L],L+1);return!0},i.prototype.reset=function(){return this.freemem(),yl(this.Qa)===0&&vl(this.Qa)===0},i.prototype.freemem=function(){for(var k;(k=this.lb.pop())!==void 0;)Vt(k)},i.prototype.free=function(){this.freemem();var k=El(this.Qa)===0;return delete this.db.fb[this.Qa],this.Qa=0,k},c.prototype.next=function(){if(this.eb===null)return{done:!0};if(this.Za!==null&&(this.Za.free(),this.Za=null),!this.db.db)throw this.mb(),Error("Database closed");var k=At(),L=Ze(4);je(T),je(L);try{this.db.handleError(Wn(this.db.db,this.kb,-1,T,L)),this.kb=ne(L,"i32");var G=ne(T,"i32");return G===0?(this.mb(),{done:!0}):(this.Za=new i(G,this.db),this.db.fb[G]=this.Za,{value:this.Za,done:!1})}catch(ee){throw this.pb=Qe(this.kb),this.mb(),ee}finally{qt(k)}},c.prototype.mb=function(){Vt(this.eb),this.eb=null},c.prototype.getRemainingSQL=function(){return this.pb!==null?this.pb:Qe(this.kb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(c.prototype[Symbol.iterator]=function(){return this}),b.prototype.run=function(k,L){if(!this.db)throw"Database closed";if(L){k=this.prepare(k,L);try{k.step()}finally{k.free()}}else this.handleError(de(this.db,k,0,0,T));return this},b.prototype.exec=function(k,L,G){if(!this.db)throw"Database closed";var ee=At(),ie=null;try{var be=on(k),Ve=Ze(4);for(k=[];ne(be,"i8")!==0;){je(T),je(Ve),this.handleError(Wn(this.db,be,-1,T,Ve));var ze=ne(T,"i32");if(be=ne(Ve,"i32"),ze!==0){var Ie=null;for(ie=new i(ze,this),L!=null&&ie.bind(L);ie.step();)Ie===null&&(Ie={columns:ie.getColumnNames(),values:[]},k.push(Ie)),Ie.values.push(ie.get(null,G));ie.free()}}return k}catch(Ue){throw ie&&ie.free(),Ue}finally{qt(ee)}},b.prototype.each=function(k,L,G,ee,ie){typeof L=="function"&&(ee=G,G=L,L=void 0),k=this.prepare(k,L);try{for(;k.step();)G(k.getAsObject(null,ie))}finally{k.free()}if(typeof ee=="function")return ee()},b.prototype.prepare=function(k,L){if(je(T),this.handleError(Re(this.db,k,-1,T,0)),k=ne(T,"i32"),k===0)throw"Nothing to prepare";var G=new i(k,this);return L!=null&&G.bind(L),this.fb[k]=G},b.prototype.iterateStatements=function(k){return new c(k,this)},b.prototype.export=function(){Object.values(this.fb).forEach(function(L){L.free()}),Object.values(this.Sa).forEach(Ke),this.Sa={},this.handleError(he(this.db));var k=el(this.filename);return this.handleError(Y(this.filename,T)),this.db=ne(T,"i32"),Kn(this.db),k},b.prototype.close=function(){this.db!==null&&(Object.values(this.fb).forEach(function(k){k.free()}),Object.values(this.Sa).forEach(Ke),this.Sa={},this.Ya&&(Ke(this.Ya),this.Ya=void 0),this.handleError(he(this.db)),Mn("/"+this.filename),this.db=null)},b.prototype.handleError=function(k){if(k===0)return null;throw k=dl(this.db),Error(k)},b.prototype.getRowsModified=function(){return ke(this.db)},b.prototype.create_function=function(k,L){Object.prototype.hasOwnProperty.call(this.Sa,k)&&(Ke(this.Sa[k]),delete this.Sa[k]);var G=Ct(function(ee,ie,be){ie=r(ie,be);try{var Ve=L.apply(null,ie)}catch(ze){Ut(ee,ze,-1);return}e(ee,Ve)},"viii");return this.Sa[k]=G,this.handleError(Xn(this.db,k,L.length,1,0,G,0,0,0)),this},b.prototype.create_aggregate=function(k,L){var G=L.init||function(){return null},ee=L.finalize||function(Ie){return Ie},ie=L.step;if(!ie)throw"An aggregate function must have a step function in "+k;var be={};Object.hasOwnProperty.call(this.Sa,k)&&(Ke(this.Sa[k]),delete this.Sa[k]),L=k+"__finalize",Object.hasOwnProperty.call(this.Sa,L)&&(Ke(this.Sa[L]),delete this.Sa[L]);var Ve=Ct(function(Ie,Ue,fn){var at=Yn(Ie,1);Object.hasOwnProperty.call(be,at)||(be[at]=G()),Ue=r(Ue,fn),Ue=[be[at]].concat(Ue);try{be[at]=ie.apply(null,Ue)}catch(Rl){delete be[at],Ut(Ie,Rl,-1)}},"viii"),ze=Ct(function(Ie){var Ue=Yn(Ie,1);try{var fn=ee(be[Ue])}catch(at){delete be[Ue],Ut(Ie,at,-1);return}e(Ie,fn),delete be[Ue]},"vi");return this.Sa[k]=Ve,this.Sa[L]=ze,this.handleError(Xn(this.db,k,ie.length-1,1,0,0,Ve,ze,0)),this},b.prototype.updateHook=function(k){this.Ya&&(Zn(this.db,0,0),Ke(this.Ya),this.Ya=void 0),k&&(this.Ya=Ct(function(L,G,ee,ie,be){switch(G){case 18:L="insert";break;case 23:L="update";break;case 9:L="delete";break;default:throw"unknown operationCode in updateHook callback: "+G}if(ee=ee?ce(M,ee):"",ie=ie?ce(M,ie):"",be>Number.MAX_SAFE_INTEGER)throw"rowId too big to fit inside a Number";k(L,ee,ie,Number(be))},"viiiij"),Zn(this.db,this.Ya,0))},a.Database=b};var S={...a},C="./this.program",_=(e,r)=>{throw r},y="",P,D;if(w){var $=tr;y=__dirname+"/",D=e=>(e=ae(e)?new URL(e):e,$.readFileSync(e)),P=async e=>(e=ae(e)?new URL(e):e,$.readFileSync(e,void 0)),!a.thisProgram&&1<process.argv.length&&(C=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),l.exports=a,_=(e,r)=>{throw process.exitCode=e,r}}else(p||g)&&(g?y=self.location.href:typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),y=y.startsWith("blob:")?"":y.slice(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1),g&&(D=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),P=async e=>{if(ae(e))return new Promise((i,c)=>{var b=new XMLHttpRequest;b.open("GET",e,!0),b.responseType="arraybuffer",b.onload=()=>{b.status==200||b.status==0&&b.response?i(b.response):c(b.status)},b.onerror=c,b.send(null)});var r=await fetch(e,{credentials:"same-origin"});if(r.ok)return r.arrayBuffer();throw Error(r.status+" : "+r.url)});var B=a.print||console.log.bind(console),re=a.printErr||console.error.bind(console);Object.assign(a,S),S=null,a.thisProgram&&(C=a.thisProgram);var W=a.wasmBinary,I,H=!1,A,z,M,K,R,N,le,pe,se,ae=e=>e.startsWith("file://");function J(){var e=I.buffer;a.HEAP8=z=new Int8Array(e),a.HEAP16=K=new Int16Array(e),a.HEAPU8=M=new Uint8Array(e),a.HEAPU16=new Uint16Array(e),a.HEAP32=R=new Int32Array(e),a.HEAPU32=N=new Uint32Array(e),a.HEAPF32=le=new Float32Array(e),a.HEAPF64=se=new Float64Array(e),a.HEAP64=pe=new BigInt64Array(e),a.HEAPU64=new BigUint64Array(e)}var oe=0,we=null;function ve(e){var r;throw(r=a.onAbort)==null||r.call(a,e),e="Aborted("+e+")",re(e),H=!0,new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info.")}var qe;async function Te(e){if(!W)try{var r=await P(e);return new Uint8Array(r)}catch{}if(e==qe&&W)e=new Uint8Array(W);else if(D)e=D(e);else throw"both async and sync fetching of the wasm failed";return e}async function Ce(e,r){try{var i=await Te(e);return await WebAssembly.instantiate(i,r)}catch(c){re(`failed to asynchronously prepare wasm: ${c}`),ve(c)}}async function De(e){var r=qe;if(!W&&typeof WebAssembly.instantiateStreaming=="function"&&!ae(r)&&!w)try{var i=fetch(r,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(i,e)}catch(c){re(`wasm streaming compile failed: ${c}`),re("falling back to ArrayBuffer instantiation")}return Ce(r,e)}class Ee{constructor(r){We(this,"name","ExitStatus");this.message=`Program terminated with exit(${r})`,this.status=r}}var x=e=>{for(;0<e.length;)e.shift()(a)},te=[],O=[],X=()=>{var e=a.preRun.shift();O.unshift(e)};function ne(e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":return z[e];case"i8":return z[e];case"i16":return K[e>>1];case"i32":return R[e>>2];case"i64":return pe[e>>3];case"float":return le[e>>2];case"double":return se[e>>3];case"*":return N[e>>2];default:ve(`invalid type for getValue: ${r}`)}}var Se=a.noExitRuntime||!0;function je(e){var r="i32";switch(r.endsWith("*")&&(r="*"),r){case"i1":z[e]=0;break;case"i8":z[e]=0;break;case"i16":K[e>>1]=0;break;case"i32":R[e>>2]=0;break;case"i64":pe[e>>3]=BigInt(0);break;case"float":le[e>>2]=0;break;case"double":se[e>>3]=0;break;case"*":N[e>>2]=0;break;default:ve(`invalid type for setValue: ${r}`)}}var ye=typeof TextDecoder<"u"?new TextDecoder:void 0,ce=(e,r=0,i=NaN)=>{var c=r+i;for(i=r;e[i]&&!(i>=c);)++i;if(16<i-r&&e.buffer&&ye)return ye.decode(e.subarray(r,i));for(c="";r<i;){var b=e[r++];if(b&128){var T=e[r++]&63;if((b&224)==192)c+=String.fromCharCode((b&31)<<6|T);else{var q=e[r++]&63;b=(b&240)==224?(b&15)<<12|T<<6|q:(b&7)<<18|T<<12|q<<6|e[r++]&63,65536>b?c+=String.fromCharCode(b):(b-=65536,c+=String.fromCharCode(55296|b>>10,56320|b&1023))}}else c+=String.fromCharCode(b)}return c},Qe=(e,r)=>e?ce(M,e,r):"",Wt=(e,r)=>{for(var i=0,c=e.length-1;0<=c;c--){var b=e[c];b==="."?e.splice(c,1):b===".."?(e.splice(c,1),i++):i&&(e.splice(c,1),i--)}if(r)for(;i;i--)e.unshift("..");return e},rt=e=>{var r=e.charAt(0)==="/",i=e.slice(-1)==="/";return(e=Wt(e.split("/").filter(c=>!!c),!r).join("/"))||r||(e="."),e&&i&&(e+="/"),(r?"/":"")+e},lt=e=>{var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1);return e=r[0],r=r[1],!e&&!r?".":(r&&(r=r.slice(0,-1)),e+r)},ht=e=>e&&e.match(/([^\/]+|\/)\/*$/)[1],Gt=()=>{if(w){var e=tr;return r=>e.randomFillSync(r)}return r=>crypto.getRandomValues(r)},Et=e=>{(Et=Gt())(e)},Ht=(...e)=>{for(var r="",i=!1,c=e.length-1;-1<=c&&!i;c--){if(i=0<=c?e[c]:"/",typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!i)return"";r=i+"/"+r,i=i.charAt(0)==="/"}return r=Wt(r.split("/").filter(b=>!!b),!i).join("/"),(i?"/":"")+r||"."},Xt=[],kt=e=>{for(var r=0,i=0;i<e.length;++i){var c=e.charCodeAt(i);127>=c?r++:2047>=c?r+=2:55296<=c&&57343>=c?(r+=4,++i):r+=3}return r},Ge=(e,r,i,c)=>{if(!(0<c))return 0;var b=i;c=i+c-1;for(var T=0;T<e.length;++T){var q=e.charCodeAt(T);if(55296<=q&&57343>=q){var Y=e.charCodeAt(++T);q=65536+((q&1023)<<10)|Y&1023}if(127>=q){if(i>=c)break;r[i++]=q}else{if(2047>=q){if(i+1>=c)break;r[i++]=192|q>>6}else{if(65535>=q){if(i+2>=c)break;r[i++]=224|q>>12}else{if(i+3>=c)break;r[i++]=240|q>>18,r[i++]=128|q>>12&63}r[i++]=128|q>>6&63}r[i++]=128|q&63}}return r[i]=0,i-b},_n=(e,r)=>{var i=Array(kt(e)+1);return e=Ge(e,i,0,i.length),r&&(i.length=e),i},wn=[];function vn(e,r){wn[e]={input:[],output:[],cb:r},xt(e,Gr)}var Gr={open(e){var r=wn[e.node.rdev];if(!r)throw new j(43);e.tty=r,e.seekable=!1},close(e){e.tty.cb.fsync(e.tty)},fsync(e){e.tty.cb.fsync(e.tty)},read(e,r,i,c){if(!e.tty||!e.tty.cb.xb)throw new j(60);for(var b=0,T=0;T<c;T++){try{var q=e.tty.cb.xb(e.tty)}catch{throw new j(29)}if(q===void 0&&b===0)throw new j(6);if(q==null)break;b++,r[i+T]=q}return b&&(e.node.atime=Date.now()),b},write(e,r,i,c){if(!e.tty||!e.tty.cb.qb)throw new j(60);try{for(var b=0;b<c;b++)e.tty.cb.qb(e.tty,r[i+b])}catch{throw new j(29)}return c&&(e.node.mtime=e.node.ctime=Date.now()),b}},Hr={xb(){e:{if(!Xt.length){var e=null;if(w){var r=Buffer.alloc(256),i=0,c=process.stdin.fd;try{i=$.readSync(c,r,0,256)}catch(b){if(b.toString().includes("EOF"))i=0;else throw b}0<i&&(e=r.slice(0,i).toString("utf-8"))}else typeof window<"u"&&typeof window.prompt=="function"&&(e=window.prompt("Input: "),e!==null&&(e+=`
`));if(!e){e=null;break e}Xt=_n(e,!0)}e=Xt.shift()}return e},qb(e,r){r===null||r===10?(B(ce(e.output)),e.output=[]):r!=0&&e.output.push(r)},fsync(e){var r;0<((r=e.output)==null?void 0:r.length)&&(B(ce(e.output)),e.output=[])},Tb(){return{Ob:25856,Qb:5,Nb:191,Pb:35387,Mb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Ub(){return 0},Vb(){return[24,80]}},Xr={qb(e,r){r===null||r===10?(re(ce(e.output)),e.output=[]):r!=0&&e.output.push(r)},fsync(e){var r;0<((r=e.output)==null?void 0:r.length)&&(re(ce(e.output)),e.output=[])}},ue={Wa:null,Xa(){return ue.createNode(null,"/",16895,0)},createNode(e,r,i,c){if((i&61440)===24576||(i&61440)===4096)throw new j(63);return ue.Wa||(ue.Wa={dir:{node:{Ta:ue.La.Ta,Ua:ue.La.Ua,lookup:ue.La.lookup,hb:ue.La.hb,rename:ue.La.rename,unlink:ue.La.unlink,rmdir:ue.La.rmdir,readdir:ue.La.readdir,symlink:ue.La.symlink},stream:{Va:ue.Ma.Va}},file:{node:{Ta:ue.La.Ta,Ua:ue.La.Ua},stream:{Va:ue.Ma.Va,read:ue.Ma.read,write:ue.Ma.write,ib:ue.Ma.ib,jb:ue.Ma.jb}},link:{node:{Ta:ue.La.Ta,Ua:ue.La.Ua,readlink:ue.La.readlink},stream:{}},ub:{node:{Ta:ue.La.Ta,Ua:ue.La.Ua},stream:$r}}),i=Cn(e,r,i,c),Ne(i.mode)?(i.La=ue.Wa.dir.node,i.Ma=ue.Wa.dir.stream,i.Na={}):(i.mode&61440)===32768?(i.La=ue.Wa.file.node,i.Ma=ue.Wa.file.stream,i.Ra=0,i.Na=null):(i.mode&61440)===40960?(i.La=ue.Wa.link.node,i.Ma=ue.Wa.link.stream):(i.mode&61440)===8192&&(i.La=ue.Wa.ub.node,i.Ma=ue.Wa.ub.stream),i.atime=i.mtime=i.ctime=Date.now(),e&&(e.Na[r]=i,e.atime=e.mtime=e.ctime=i.atime),i},Sb(e){return e.Na?e.Na.subarray?e.Na.subarray(0,e.Ra):new Uint8Array(e.Na):new Uint8Array(0)},La:{Ta(e){var r={};return r.dev=(e.mode&61440)===8192?e.id:1,r.ino=e.id,r.mode=e.mode,r.nlink=1,r.uid=0,r.gid=0,r.rdev=e.rdev,Ne(e.mode)?r.size=4096:(e.mode&61440)===32768?r.size=e.Ra:(e.mode&61440)===40960?r.size=e.link.length:r.size=0,r.atime=new Date(e.atime),r.mtime=new Date(e.mtime),r.ctime=new Date(e.ctime),r.blksize=4096,r.blocks=Math.ceil(r.size/r.blksize),r},Ua(e,r){for(var i of["mode","atime","mtime","ctime"])r[i]!=null&&(e[i]=r[i]);r.size!==void 0&&(r=r.size,e.Ra!=r&&(r==0?(e.Na=null,e.Ra=0):(i=e.Na,e.Na=new Uint8Array(r),i&&e.Na.set(i.subarray(0,Math.min(r,e.Ra))),e.Ra=r)))},lookup(){throw ue.vb},hb(e,r,i,c){return ue.createNode(e,r,i,c)},rename(e,r,i){try{var c=ot(r,i)}catch{}if(c){if(Ne(e.mode))for(var b in c.Na)throw new j(55);Zt(c)}delete e.parent.Na[e.name],r.Na[i]=e,e.name=i,r.ctime=r.mtime=e.parent.ctime=e.parent.mtime=Date.now()},unlink(e,r){delete e.Na[r],e.ctime=e.mtime=Date.now()},rmdir(e,r){var i=ot(e,r),c;for(c in i.Na)throw new j(55);delete e.Na[r],e.ctime=e.mtime=Date.now()},readdir(e){return[".","..",...Object.keys(e.Na)]},symlink(e,r,i){return e=ue.createNode(e,r,41471,0),e.link=i,e},readlink(e){if((e.mode&61440)!==40960)throw new j(28);return e.link}},Ma:{read(e,r,i,c,b){var T=e.node.Na;if(b>=e.node.Ra)return 0;if(e=Math.min(e.node.Ra-b,c),8<e&&T.subarray)r.set(T.subarray(b,b+e),i);else for(c=0;c<e;c++)r[i+c]=T[b+c];return e},write(e,r,i,c,b,T){if(r.buffer===z.buffer&&(T=!1),!c)return 0;if(e=e.node,e.mtime=e.ctime=Date.now(),r.subarray&&(!e.Na||e.Na.subarray)){if(T)return e.Na=r.subarray(i,i+c),e.Ra=c;if(e.Ra===0&&b===0)return e.Na=r.slice(i,i+c),e.Ra=c;if(b+c<=e.Ra)return e.Na.set(r.subarray(i,i+c),b),c}T=b+c;var q=e.Na?e.Na.length:0;if(q>=T||(T=Math.max(T,q*(1048576>q?2:1.125)>>>0),q!=0&&(T=Math.max(T,256)),q=e.Na,e.Na=new Uint8Array(T),0<e.Ra&&e.Na.set(q.subarray(0,e.Ra),0)),e.Na.subarray&&r.subarray)e.Na.set(r.subarray(i,i+c),b);else for(T=0;T<c;T++)e.Na[b+T]=r[i+T];return e.Ra=Math.max(e.Ra,b+c),c},Va(e,r,i){if(i===1?r+=e.position:i===2&&(e.node.mode&61440)===32768&&(r+=e.node.Ra),0>r)throw new j(28);return r},ib(e,r,i,c,b){if((e.node.mode&61440)!==32768)throw new j(43);if(e=e.node.Na,b&2||!e||e.buffer!==z.buffer){b=!0,c=65536*Math.ceil(r/65536);var T=Un(65536,c);if(T&&M.fill(0,T,T+c),c=T,!c)throw new j(48);e&&((0<i||i+r<e.length)&&(e.subarray?e=e.subarray(i,i+r):e=Array.prototype.slice.call(e,i,i+r)),z.set(e,c))}else b=!1,c=e.byteOffset;return{Kb:c,Ab:b}},jb(e,r,i,c){return ue.Ma.write(e,r,0,c,i,!1),0}}},yn=(e,r)=>{var i=0;return e&&(i|=365),r&&(i|=146),i},Jt=null,En={},mt=[],Jr=1,Je=null,kn=!1,Tn=!0,Sn={},j=class{constructor(e){We(this,"name","ErrnoError");this.Pa=e}},Yr=class{constructor(){We(this,"gb",{});We(this,"node",null)}get flags(){return this.gb.flags}set flags(e){this.gb.flags=e}get position(){return this.gb.position}set position(e){this.gb.position=e}},Kr=class{constructor(e,r,i,c){We(this,"La",{});We(this,"Ma",{});We(this,"ab",null);e||(e=this),this.parent=e,this.Xa=e.Xa,this.id=Jr++,this.name=r,this.mode=i,this.rdev=c,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&365)===365}set read(e){e?this.mode|=365:this.mode&=-366}get write(){return(this.mode&146)===146}set write(e){e?this.mode|=146:this.mode&=-147}};function Fe(e,r={}){if(!e)throw new j(44);r.nb??(r.nb=!0),e.charAt(0)==="/"||(e="//"+e);var i=0;e:for(;40>i;i++){e=e.split("/").filter(Y=>!!Y);for(var c=Jt,b="/",T=0;T<e.length;T++){var q=T===e.length-1;if(q&&r.parent)break;if(e[T]!==".")if(e[T]==="..")b=lt(b),c=c.parent;else{b=rt(b+"/"+e[T]);try{c=ot(c,e[T])}catch(Y){if((Y==null?void 0:Y.Pa)===44&&q&&r.Jb)return{path:b};throw Y}if(!c.ab||q&&!r.nb||(c=c.ab.root),(c.mode&61440)===40960&&(!q||r.$a)){if(!c.La.readlink)throw new j(52);c=c.La.readlink(c),c.charAt(0)==="/"||(c=lt(b)+"/"+c),e=c+"/"+e.slice(T+1).join("/");continue e}}}return{path:b,node:c}}throw new j(32)}function Yt(e){for(var r;;){if(e===e.parent)return e=e.Xa.zb,r?e[e.length-1]!=="/"?`${e}/${r}`:e+r:e;r=r?`${e.name}/${r}`:e.name,e=e.parent}}function Kt(e,r){for(var i=0,c=0;c<r.length;c++)i=(i<<5)-i+r.charCodeAt(c)|0;return(e+i>>>0)%Je.length}function Zt(e){var r=Kt(e.parent.id,e.name);if(Je[r]===e)Je[r]=e.bb;else for(r=Je[r];r;){if(r.bb===e){r.bb=e.bb;break}r=r.bb}}function ot(e,r){var i=Ne(e.mode)?(i=pt(e,"x"))?i:e.La.lookup?0:2:54;if(i)throw new j(i);for(i=Je[Kt(e.id,r)];i;i=i.bb){var c=i.name;if(i.parent.id===e.id&&c===r)return i}return e.La.lookup(e,r)}function Cn(e,r,i,c){return e=new Kr(e,r,i,c),r=Kt(e.parent.id,e.name),e.bb=Je[r],Je[r]=e}function Ne(e){return(e&61440)===16384}function qn(e){var r=["r","w","rw"][e&3];return e&512&&(r+="w"),r}function pt(e,r){if(Tn)return 0;if(!r.includes("r")||e.mode&292){if(r.includes("w")&&!(e.mode&146)||r.includes("x")&&!(e.mode&73))return 2}else return 2;return 0}function An(e,r){if(!Ne(e.mode))return 54;try{return ot(e,r),20}catch{}return pt(e,"wx")}function Pn(e,r,i){try{var c=ot(e,r)}catch(b){return b.Pa}if(e=pt(e,"wx"))return e;if(i){if(!Ne(c.mode))return 54;if(c===c.parent||Yt(c)==="/")return 10}else if(Ne(c.mode))return 31;return 0}function Nt(e){if(!e)throw new j(63);return e}function Le(e){if(e=mt[e],!e)throw new j(8);return e}function Ln(e,r=-1){if(e=Object.assign(new Yr,e),r==-1)e:{for(r=0;4096>=r;r++)if(!mt[r])break e;throw new j(33)}return e.fd=r,mt[r]=e}function Zr(e,r=-1){var i,c;return e=Ln(e,r),(c=(i=e.Ma)==null?void 0:i.Rb)==null||c.call(i,e),e}function $t(e,r,i){var c=e==null?void 0:e.Ma.Ua;e=c?e:r,c??(c=r.La.Ua),Nt(c),c(e,i)}var $r={open(e){var r,i;e.Ma=En[e.node.rdev].Ma,(i=(r=e.Ma).open)==null||i.call(r,e)},Va(){throw new j(70)}};function xt(e,r){En[e]={Ma:r}}function Nn(e,r){var i=r==="/";if(i&&Jt)throw new j(10);if(!i&&r){var c=Fe(r,{nb:!1});if(r=c.path,c=c.node,c.ab)throw new j(10);if(!Ne(c.mode))throw new j(54)}r={type:e,Wb:{},zb:r,Ib:[]},e=e.Xa(r),e.Xa=r,r.root=e,i?Jt=e:c&&(c.ab=r,c.Xa&&c.Xa.Ib.push(r))}function Rt(e,r,i){var c=Fe(e,{parent:!0}).node;if(e=ht(e),!e)throw new j(28);if(e==="."||e==="..")throw new j(20);var b=An(c,e);if(b)throw new j(b);if(!c.La.hb)throw new j(63);return c.La.hb(c,e,r,i)}function xr(e,r=438){return Rt(e,r&4095|32768,0)}function Be(e,r=511){return Rt(e,r&1023|16384,0)}function Mt(e,r,i){typeof i>"u"&&(i=r,r=438),Rt(e,r|8192,i)}function en(e,r){if(!Ht(e))throw new j(44);var i=Fe(r,{parent:!0}).node;if(!i)throw new j(44);r=ht(r);var c=An(i,r);if(c)throw new j(c);if(!i.La.symlink)throw new j(63);i.La.symlink(i,r,e)}function Rn(e){var r=Fe(e,{parent:!0}).node;e=ht(e);var i=ot(r,e),c=Pn(r,e,!0);if(c)throw new j(c);if(!r.La.rmdir)throw new j(63);if(i.ab)throw new j(10);r.La.rmdir(r,e),Zt(i)}function Mn(e){var r=Fe(e,{parent:!0}).node;if(!r)throw new j(44);e=ht(e);var i=ot(r,e),c=Pn(r,e,!1);if(c)throw new j(c);if(!r.La.unlink)throw new j(63);if(i.ab)throw new j(10);r.La.unlink(r,e),Zt(i)}function Tt(e,r){return e=Fe(e,{$a:!r}).node,Nt(e.La.Ta)(e)}function Dn(e,r,i,c){$t(e,r,{mode:i&4095|r.mode&-4096,ctime:Date.now(),Fb:c})}function Dt(e,r){e=typeof e=="string"?Fe(e,{$a:!0}).node:e,Dn(null,e,r)}function In(e,r,i){if(Ne(r.mode))throw new j(31);if((r.mode&61440)!==32768)throw new j(28);var c=pt(r,"w");if(c)throw new j(c);$t(e,r,{size:i,timestamp:Date.now()})}function bt(e,r,i=438){if(e==="")throw new j(44);if(typeof r=="string"){var c={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[r];if(typeof c>"u")throw Error(`Unknown file open mode: ${r}`);r=c}if(i=r&64?i&4095|32768:0,typeof e=="object")c=e;else{var b=e.endsWith("/");e=Fe(e,{$a:!(r&131072),Jb:!0}),c=e.node,e=e.path}var T=!1;if(r&64)if(c){if(r&128)throw new j(20)}else{if(b)throw new j(31);c=Rt(e,i|511,0),T=!0}if(!c)throw new j(44);if((c.mode&61440)===8192&&(r&=-513),r&65536&&!Ne(c.mode))throw new j(54);if(!T&&(b=c?(c.mode&61440)===40960?32:Ne(c.mode)&&(qn(r)!=="r"||r&576)?31:pt(c,qn(r)):44))throw new j(b);return r&512&&!T&&(b=c,b=typeof b=="string"?Fe(b,{$a:!0}).node:b,In(null,b,0)),r&=-131713,b=Ln({node:c,path:Yt(c),flags:r,seekable:!0,position:0,Ma:c.Ma,Lb:[],error:!1}),b.Ma.open&&b.Ma.open(b),T&&Dt(c,i&511),!a.logReadFiles||r&1||e in Sn||(Sn[e]=1),b}function tn(e){if(e.fd===null)throw new j(8);e.ob&&(e.ob=null);try{e.Ma.close&&e.Ma.close(e)}catch(r){throw r}finally{mt[e.fd]=null}e.fd=null}function On(e,r,i){if(e.fd===null)throw new j(8);if(!e.seekable||!e.Ma.Va)throw new j(70);if(i!=0&&i!=1&&i!=2)throw new j(28);e.position=e.Ma.Va(e,r,i),e.Lb=[]}function Fn(e,r,i,c,b){if(0>c||0>b)throw new j(28);if(e.fd===null)throw new j(8);if((e.flags&2097155)===1)throw new j(8);if(Ne(e.node.mode))throw new j(31);if(!e.Ma.read)throw new j(28);var T=typeof b<"u";if(!T)b=e.position;else if(!e.seekable)throw new j(70);return r=e.Ma.read(e,r,i,c,b),T||(e.position+=r),r}function zn(e,r,i,c,b){if(0>c||0>b)throw new j(28);if(e.fd===null)throw new j(8);if(!(e.flags&2097155))throw new j(8);if(Ne(e.node.mode))throw new j(31);if(!e.Ma.write)throw new j(28);e.seekable&&e.flags&1024&&On(e,0,2);var T=typeof b<"u";if(!T)b=e.position;else if(!e.seekable)throw new j(70);return r=e.Ma.write(e,r,i,c,b,void 0),T||(e.position+=r),r}function el(e){var r,i=bt(e,i||0);e=Tt(e).size;var c=new Uint8Array(e);return Fn(i,c,0,e,0),r=c,tn(i),r}function Ye(e,r,i){e=rt("/dev/"+e);var c=yn(!!r,!!i);Ye.yb??(Ye.yb=64);var b=Ye.yb++<<8|0;xt(b,{open(T){T.seekable=!1},close(){var T;(T=i==null?void 0:i.buffer)!=null&&T.length&&i(10)},read(T,q,Y,he){for(var de=0,ke=0;ke<he;ke++){try{var Re=r()}catch{throw new j(29)}if(Re===void 0&&de===0)throw new j(6);if(Re==null)break;de++,q[Y+ke]=Re}return de&&(T.node.atime=Date.now()),de},write(T,q,Y,he){for(var de=0;de<he;de++)try{i(q[Y+de])}catch{throw new j(29)}return he&&(T.node.mtime=T.node.ctime=Date.now()),de}}),Mt(e,c,b)}var _e={};function it(e,r,i){if(r.charAt(0)==="/")return r;if(e=e===-100?"/":Le(e).path,r.length==0){if(!i)throw new j(44);return e}return e+"/"+r}function It(e,r){R[e>>2]=r.dev,R[e+4>>2]=r.mode,N[e+8>>2]=r.nlink,R[e+12>>2]=r.uid,R[e+16>>2]=r.gid,R[e+20>>2]=r.rdev,pe[e+24>>3]=BigInt(r.size),R[e+32>>2]=4096,R[e+36>>2]=r.blocks;var i=r.atime.getTime(),c=r.mtime.getTime(),b=r.ctime.getTime();return pe[e+40>>3]=BigInt(Math.floor(i/1e3)),N[e+48>>2]=i%1e3*1e6,pe[e+56>>3]=BigInt(Math.floor(c/1e3)),N[e+64>>2]=c%1e3*1e6,pe[e+72>>3]=BigInt(Math.floor(b/1e3)),N[e+80>>2]=b%1e3*1e6,pe[e+88>>3]=BigInt(r.ino),0}var Ot=void 0,Ft=()=>{var e=R[+Ot>>2];return Ot+=4,e},nn=0,tl=[0,31,60,91,121,152,182,213,244,274,305,335],nl=[0,31,59,90,120,151,181,212,243,273,304,334],St={},jn=e=>{var r;A=e,Se||0<nn||((r=a.onExit)==null||r.call(a,e),H=!0),_(e,new Ee(e))},rl=e=>{if(!H)try{if(e(),!(Se||0<nn))try{A=e=A,jn(e)}catch(r){r instanceof Ee||r=="unwind"||_(1,r)}}catch(r){r instanceof Ee||r=="unwind"||_(1,r)}},rn={},Vn=()=>{if(!ln){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:C||"./this.program"},r;for(r in rn)rn[r]===void 0?delete e[r]:e[r]=rn[r];var i=[];for(r in e)i.push(`${r}=${e[r]}`);ln=i}return ln},ln,on=e=>{var r=kt(e)+1,i=Ze(r);return Ge(e,M,i,r),i},ll=(e,r,i,c)=>{var b={string:de=>{var ke=0;return de!=null&&de!==0&&(ke=on(de)),ke},array:de=>{var ke=Ze(de.length);return z.set(de,ke),ke}};e=a["_"+e];var T=[],q=0;if(c)for(var Y=0;Y<c.length;Y++){var he=b[i[Y]];he?(q===0&&(q=At()),T[Y]=he(c[Y])):T[Y]=c[Y]}return i=e(...T),i=function(de){return q!==0&&qt(q),r==="string"?de?ce(M,de):"":r==="boolean"?!!de:de}(i)},zt=0,jt=(e,r)=>(r=r==1?Ze(e.length):an(e.length),e.subarray||e.slice||(e=new Uint8Array(e)),M.set(e,r),r),st,sn=[],He,Ke=e=>{st.delete(He.get(e)),He.set(e,null),sn.push(e)},Ct=(e,r)=>{if(!st){st=new WeakMap;var i=He.length;if(st)for(var c=0;c<0+i;c++){var b=He.get(c);b&&st.set(b,c)}}if(i=st.get(e)||0)return i;if(sn.length)i=sn.pop();else{try{He.grow(1)}catch(he){throw he instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":he}i=He.length-1}try{He.set(i,e)}catch(he){if(!(he instanceof TypeError))throw he;if(typeof WebAssembly.Function=="function"){var T=WebAssembly.Function;c={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},b={parameters:[],results:r[0]=="v"?[]:[c[r[0]]]};for(var q=1;q<r.length;++q)b.parameters.push(c[r[q]]);r=new T(b,e)}else{c=[1],b=r.slice(0,1),r=r.slice(1),q={i:127,p:127,j:126,f:125,d:124,e:111},c.push(96);var Y=r.length;128>Y?c.push(Y):c.push(Y%128|128,Y>>7);for(T of r)c.push(q[T]);b=="v"?c.push(0):c.push(1,q[b]),r=[0,97,115,109,1,0,0,0,1],T=c.length,128>T?r.push(T):r.push(T%128|128,T>>7),r.push(...c),r.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),r=new WebAssembly.Module(new Uint8Array(r)),r=new WebAssembly.Instance(r,{e:{f:e}}).exports.f}He.set(i,r)}return st.set(e,i),i};Je=Array(4096),Nn(ue,"/"),Be("/tmp"),Be("/home"),Be("/home/web_user"),function(){Be("/dev"),xt(259,{read:()=>0,write:(c,b,T,q)=>q,Va:()=>0}),Mt("/dev/null",259),vn(1280,Hr),vn(1536,Xr),Mt("/dev/tty",1280),Mt("/dev/tty1",1536);var e=new Uint8Array(1024),r=0,i=()=>(r===0&&(Et(e),r=e.byteLength),e[--r]);Ye("random",i),Ye("urandom",i),Be("/dev/shm"),Be("/dev/shm/tmp")}(),function(){Be("/proc");var e=Be("/proc/self");Be("/proc/self/fd"),Nn({Xa(){var r=Cn(e,"fd",16895,73);return r.Ma={Va:ue.Ma.Va},r.La={lookup(i,c){i=+c;var b=Le(i);return i={parent:null,Xa:{zb:"fake"},La:{readlink:()=>b.path},id:i+1},i.parent=i},readdir(){return Array.from(mt.entries()).filter(([,i])=>i).map(([i])=>i.toString())}},r}},"/proc/self/fd")}(),ue.vb=new j(44),ue.vb.stack="<generic error, no stack>";var ol={a:(e,r,i,c)=>ve(`Assertion failed: ${e?ce(M,e):""}, at: `+[r?r?ce(M,r):"":"unknown filename",i,c?c?ce(M,c):"":"unknown function"]),i:function(e,r){try{return e=e?ce(M,e):"",Dt(e,r),0}catch(i){if(typeof _e>"u"||i.name!=="ErrnoError")throw i;return-i.Pa}},L:function(e,r,i){try{if(r=r?ce(M,r):"",r=it(e,r),i&-8)return-28;var c=Fe(r,{$a:!0}).node;return c?(e="",i&4&&(e+="r"),i&2&&(e+="w"),i&1&&(e+="x"),e&&pt(c,e)?-2:0):-44}catch(b){if(typeof _e>"u"||b.name!=="ErrnoError")throw b;return-b.Pa}},j:function(e,r){try{var i=Le(e);return Dn(i,i.node,r,!1),0}catch(c){if(typeof _e>"u"||c.name!=="ErrnoError")throw c;return-c.Pa}},h:function(e){try{var r=Le(e);return $t(r,r.node,{timestamp:Date.now(),Fb:!1}),0}catch(i){if(typeof _e>"u"||i.name!=="ErrnoError")throw i;return-i.Pa}},b:function(e,r,i){Ot=i;try{var c=Le(e);switch(r){case 0:var b=Ft();if(0>b)break;for(;mt[b];)b++;return Zr(c,b).fd;case 1:case 2:return 0;case 3:return c.flags;case 4:return b=Ft(),c.flags|=b,0;case 12:return b=Ft(),K[b+0>>1]=2,0;case 13:case 14:return 0}return-28}catch(T){if(typeof _e>"u"||T.name!=="ErrnoError")throw T;return-T.Pa}},g:function(e,r){try{var i=Le(e),c=i.node,b=i.Ma.Ta;e=b?i:c,b??(b=c.La.Ta),Nt(b);var T=b(e);return It(r,T)}catch(q){if(typeof _e>"u"||q.name!=="ErrnoError")throw q;return-q.Pa}},H:function(e,r){r=-9007199254740992>r||9007199254740992<r?NaN:Number(r);try{if(isNaN(r))return 61;var i=Le(e);if(0>r||!(i.flags&2097155))throw new j(28);return In(i,i.node,r),0}catch(c){if(typeof _e>"u"||c.name!=="ErrnoError")throw c;return-c.Pa}},G:function(e,r){try{if(r===0)return-28;var i=kt("/")+1;return r<i?-68:(Ge("/",M,e,r),i)}catch(c){if(typeof _e>"u"||c.name!=="ErrnoError")throw c;return-c.Pa}},K:function(e,r){try{return e=e?ce(M,e):"",It(r,Tt(e,!0))}catch(i){if(typeof _e>"u"||i.name!=="ErrnoError")throw i;return-i.Pa}},C:function(e,r,i){try{return r=r?ce(M,r):"",r=it(e,r),Be(r,i),0}catch(c){if(typeof _e>"u"||c.name!=="ErrnoError")throw c;return-c.Pa}},J:function(e,r,i,c){try{r=r?ce(M,r):"";var b=c&256;return r=it(e,r,c&4096),It(i,b?Tt(r,!0):Tt(r))}catch(T){if(typeof _e>"u"||T.name!=="ErrnoError")throw T;return-T.Pa}},x:function(e,r,i,c){Ot=c;try{r=r?ce(M,r):"",r=it(e,r);var b=c?Ft():0;return bt(r,i,b).fd}catch(T){if(typeof _e>"u"||T.name!=="ErrnoError")throw T;return-T.Pa}},v:function(e,r,i,c){try{if(r=r?ce(M,r):"",r=it(e,r),0>=c)return-28;var b=Fe(r).node;if(!b)throw new j(44);if(!b.La.readlink)throw new j(28);var T=b.La.readlink(b),q=Math.min(c,kt(T)),Y=z[i+q];return Ge(T,M,i,c+1),z[i+q]=Y,q}catch(he){if(typeof _e>"u"||he.name!=="ErrnoError")throw he;return-he.Pa}},u:function(e){try{return e=e?ce(M,e):"",Rn(e),0}catch(r){if(typeof _e>"u"||r.name!=="ErrnoError")throw r;return-r.Pa}},f:function(e,r){try{return e=e?ce(M,e):"",It(r,Tt(e))}catch(i){if(typeof _e>"u"||i.name!=="ErrnoError")throw i;return-i.Pa}},r:function(e,r,i){try{return r=r?ce(M,r):"",r=it(e,r),i===0?Mn(r):i===512?Rn(r):ve("Invalid flags passed to unlinkat"),0}catch(c){if(typeof _e>"u"||c.name!=="ErrnoError")throw c;return-c.Pa}},q:function(e,r,i){try{r=r?ce(M,r):"",r=it(e,r,!0);var c=Date.now(),b,T;if(i){var q=N[i>>2]+4294967296*R[i+4>>2],Y=R[i+8>>2];Y==1073741823?b=c:Y==1073741822?b=null:b=1e3*q+Y/1e6,i+=16,q=N[i>>2]+4294967296*R[i+4>>2],Y=R[i+8>>2],Y==1073741823?T=c:Y==1073741822?T=null:T=1e3*q+Y/1e6}else T=b=c;if((T??b)!==null){e=b;var he=Fe(r,{$a:!0}).node;Nt(he.La.Ua)(he,{atime:e,mtime:T})}return 0}catch(de){if(typeof _e>"u"||de.name!=="ErrnoError")throw de;return-de.Pa}},m:()=>ve(""),l:()=>{Se=!1,nn=0},A:function(e,r){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),e=new Date(1e3*e),R[r>>2]=e.getSeconds(),R[r+4>>2]=e.getMinutes(),R[r+8>>2]=e.getHours(),R[r+12>>2]=e.getDate(),R[r+16>>2]=e.getMonth(),R[r+20>>2]=e.getFullYear()-1900,R[r+24>>2]=e.getDay();var i=e.getFullYear();R[r+28>>2]=(i%4!==0||i%100===0&&i%400!==0?nl:tl)[e.getMonth()]+e.getDate()-1|0,R[r+36>>2]=-(60*e.getTimezoneOffset()),i=new Date(e.getFullYear(),6,1).getTimezoneOffset();var c=new Date(e.getFullYear(),0,1).getTimezoneOffset();R[r+32>>2]=(i!=c&&e.getTimezoneOffset()==Math.min(c,i))|0},y:function(e,r,i,c,b,T,q){b=-9007199254740992>b||9007199254740992<b?NaN:Number(b);try{if(isNaN(b))return 61;var Y=Le(c);if(r&2&&!(i&2)&&(Y.flags&2097155)!==2)throw new j(2);if((Y.flags&2097155)===1)throw new j(2);if(!Y.Ma.ib)throw new j(43);if(!e)throw new j(28);var he=Y.Ma.ib(Y,e,b,r,i),de=he.Kb;return R[T>>2]=he.Ab,N[q>>2]=de,0}catch(ke){if(typeof _e>"u"||ke.name!=="ErrnoError")throw ke;return-ke.Pa}},z:function(e,r,i,c,b,T){T=-9007199254740992>T||9007199254740992<T?NaN:Number(T);try{var q=Le(b);if(i&2){if(i=T,(q.node.mode&61440)!==32768)throw new j(43);if(!(c&2)){var Y=M.slice(e,e+r);q.Ma.jb&&q.Ma.jb(q,Y,i,r,c)}}}catch(he){if(typeof _e>"u"||he.name!=="ErrnoError")throw he;return-he.Pa}},n:(e,r)=>{if(St[e]&&(clearTimeout(St[e].id),delete St[e]),!r)return 0;var i=setTimeout(()=>{delete St[e],rl(()=>Qn(e,performance.now()))},r);return St[e]={id:i,Xb:r},0},B:(e,r,i,c)=>{var b=new Date().getFullYear(),T=new Date(b,0,1).getTimezoneOffset();b=new Date(b,6,1).getTimezoneOffset(),N[e>>2]=60*Math.max(T,b),R[r>>2]=+(T!=b),r=q=>{var Y=Math.abs(q);return`UTC${0<=q?"-":"+"}${String(Math.floor(Y/60)).padStart(2,"0")}${String(Y%60).padStart(2,"0")}`},e=r(T),r=r(b),b<T?(Ge(e,M,i,17),Ge(r,M,c,17)):(Ge(e,M,c,17),Ge(r,M,i,17))},d:()=>Date.now(),s:()=>2147483648,c:()=>performance.now(),o:e=>{var r=M.length;if(e>>>=0,2147483648<e)return!1;for(var i=1;4>=i;i*=2){var c=r*(1+.2/i);c=Math.min(c,e+100663296);e:{c=(Math.min(2147483648,65536*Math.ceil(Math.max(e,c)/65536))-I.buffer.byteLength+65535)/65536|0;try{I.grow(c),J();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},E:(e,r)=>{var i=0;return Vn().forEach((c,b)=>{var T=r+i;for(b=N[e+4*b>>2]=T,T=0;T<c.length;++T)z[b++]=c.charCodeAt(T);z[b]=0,i+=c.length+1}),0},F:(e,r)=>{var i=Vn();N[e>>2]=i.length;var c=0;return i.forEach(b=>c+=b.length+1),N[r>>2]=c,0},e:function(e){try{var r=Le(e);return tn(r),0}catch(i){if(typeof _e>"u"||i.name!=="ErrnoError")throw i;return i.Pa}},p:function(e,r){try{var i=Le(e);return z[r]=i.tty?2:Ne(i.mode)?3:(i.mode&61440)===40960?7:4,K[r+2>>1]=0,pe[r+8>>3]=BigInt(0),pe[r+16>>3]=BigInt(0),0}catch(c){if(typeof _e>"u"||c.name!=="ErrnoError")throw c;return c.Pa}},w:function(e,r,i,c){try{e:{var b=Le(e);e=r;for(var T,q=r=0;q<i;q++){var Y=N[e>>2],he=N[e+4>>2];e+=8;var de=Fn(b,z,Y,he,T);if(0>de){var ke=-1;break e}if(r+=de,de<he)break;typeof T<"u"&&(T+=de)}ke=r}return N[c>>2]=ke,0}catch(Re){if(typeof _e>"u"||Re.name!=="ErrnoError")throw Re;return Re.Pa}},D:function(e,r,i,c){r=-9007199254740992>r||9007199254740992<r?NaN:Number(r);try{if(isNaN(r))return 61;var b=Le(e);return On(b,r,i),pe[c>>3]=BigInt(b.position),b.ob&&r===0&&i===0&&(b.ob=null),0}catch(T){if(typeof _e>"u"||T.name!=="ErrnoError")throw T;return T.Pa}},I:function(e){var i;try{var r=Le(e);return(i=r.Ma)!=null&&i.fsync?r.Ma.fsync(r):0}catch(c){if(typeof _e>"u"||c.name!=="ErrnoError")throw c;return c.Pa}},t:function(e,r,i,c){try{e:{var b=Le(e);e=r;for(var T,q=r=0;q<i;q++){var Y=N[e>>2],he=N[e+4>>2];e+=8;var de=zn(b,z,Y,he,T);if(0>de){var ke=-1;break e}if(r+=de,de<he)break;typeof T<"u"&&(T+=de)}ke=r}return N[c>>2]=ke,0}catch(Re){if(typeof _e>"u"||Re.name!=="ErrnoError")throw Re;return Re.Pa}},k:jn},Z;(async function(){var i;function e(c){var b;return Z=c.exports,I=Z.M,J(),He=Z.O,oe--,(b=a.monitorRunDependencies)==null||b.call(a,oe),oe==0&&we&&(c=we,we=null,c()),Z}oe++,(i=a.monitorRunDependencies)==null||i.call(a,oe);var r={a:ol};return a.instantiateWasm?new Promise(c=>{a.instantiateWasm(r,(b,T)=>{e(b),c(b.exports)})}):(qe??(qe=a.locateFile?a.locateFile("sql-wasm.wasm",y):y+"sql-wasm.wasm"),e((await De(r)).instance))})(),a._sqlite3_free=e=>(a._sqlite3_free=Z.P)(e),a._sqlite3_value_text=e=>(a._sqlite3_value_text=Z.Q)(e),a._sqlite3_prepare_v2=(e,r,i,c,b)=>(a._sqlite3_prepare_v2=Z.R)(e,r,i,c,b),a._sqlite3_step=e=>(a._sqlite3_step=Z.S)(e),a._sqlite3_reset=e=>(a._sqlite3_reset=Z.T)(e),a._sqlite3_exec=(e,r,i,c,b)=>(a._sqlite3_exec=Z.U)(e,r,i,c,b),a._sqlite3_finalize=e=>(a._sqlite3_finalize=Z.V)(e),a._sqlite3_column_name=(e,r)=>(a._sqlite3_column_name=Z.W)(e,r),a._sqlite3_column_text=(e,r)=>(a._sqlite3_column_text=Z.X)(e,r),a._sqlite3_column_type=(e,r)=>(a._sqlite3_column_type=Z.Y)(e,r),a._sqlite3_errmsg=e=>(a._sqlite3_errmsg=Z.Z)(e),a._sqlite3_clear_bindings=e=>(a._sqlite3_clear_bindings=Z._)(e),a._sqlite3_value_blob=e=>(a._sqlite3_value_blob=Z.$)(e),a._sqlite3_value_bytes=e=>(a._sqlite3_value_bytes=Z.aa)(e),a._sqlite3_value_double=e=>(a._sqlite3_value_double=Z.ba)(e),a._sqlite3_value_int=e=>(a._sqlite3_value_int=Z.ca)(e),a._sqlite3_value_type=e=>(a._sqlite3_value_type=Z.da)(e),a._sqlite3_result_blob=(e,r,i,c)=>(a._sqlite3_result_blob=Z.ea)(e,r,i,c),a._sqlite3_result_double=(e,r)=>(a._sqlite3_result_double=Z.fa)(e,r),a._sqlite3_result_error=(e,r,i)=>(a._sqlite3_result_error=Z.ga)(e,r,i),a._sqlite3_result_int=(e,r)=>(a._sqlite3_result_int=Z.ha)(e,r),a._sqlite3_result_int64=(e,r)=>(a._sqlite3_result_int64=Z.ia)(e,r),a._sqlite3_result_null=e=>(a._sqlite3_result_null=Z.ja)(e),a._sqlite3_result_text=(e,r,i,c)=>(a._sqlite3_result_text=Z.ka)(e,r,i,c),a._sqlite3_aggregate_context=(e,r)=>(a._sqlite3_aggregate_context=Z.la)(e,r),a._sqlite3_column_count=e=>(a._sqlite3_column_count=Z.ma)(e),a._sqlite3_data_count=e=>(a._sqlite3_data_count=Z.na)(e),a._sqlite3_column_blob=(e,r)=>(a._sqlite3_column_blob=Z.oa)(e,r),a._sqlite3_column_bytes=(e,r)=>(a._sqlite3_column_bytes=Z.pa)(e,r),a._sqlite3_column_double=(e,r)=>(a._sqlite3_column_double=Z.qa)(e,r),a._sqlite3_bind_blob=(e,r,i,c,b)=>(a._sqlite3_bind_blob=Z.ra)(e,r,i,c,b),a._sqlite3_bind_double=(e,r,i)=>(a._sqlite3_bind_double=Z.sa)(e,r,i),a._sqlite3_bind_int=(e,r,i)=>(a._sqlite3_bind_int=Z.ta)(e,r,i),a._sqlite3_bind_text=(e,r,i,c,b)=>(a._sqlite3_bind_text=Z.ua)(e,r,i,c,b),a._sqlite3_bind_parameter_index=(e,r)=>(a._sqlite3_bind_parameter_index=Z.va)(e,r),a._sqlite3_sql=e=>(a._sqlite3_sql=Z.wa)(e),a._sqlite3_normalized_sql=e=>(a._sqlite3_normalized_sql=Z.xa)(e),a._sqlite3_changes=e=>(a._sqlite3_changes=Z.ya)(e),a._sqlite3_close_v2=e=>(a._sqlite3_close_v2=Z.za)(e),a._sqlite3_create_function_v2=(e,r,i,c,b,T,q,Y,he)=>(a._sqlite3_create_function_v2=Z.Aa)(e,r,i,c,b,T,q,Y,he),a._sqlite3_update_hook=(e,r,i)=>(a._sqlite3_update_hook=Z.Ba)(e,r,i),a._sqlite3_open=(e,r)=>(a._sqlite3_open=Z.Ca)(e,r);var an=a._malloc=e=>(an=a._malloc=Z.Da)(e),Vt=a._free=e=>(Vt=a._free=Z.Ea)(e);a._RegisterExtensionFunctions=e=>(a._RegisterExtensionFunctions=Z.Fa)(e);var Un=(e,r)=>(Un=Z.Ga)(e,r),Qn=(e,r)=>(Qn=Z.Ha)(e,r),qt=e=>(qt=Z.Ia)(e),Ze=e=>(Ze=Z.Ja)(e),At=()=>(At=Z.Ka)();a.stackSave=()=>At(),a.stackRestore=e=>qt(e),a.stackAlloc=e=>Ze(e),a.cwrap=(e,r,i,c)=>{var b=!i||i.every(T=>T==="number"||T==="boolean");return r!=="string"&&b&&!c?a["_"+e]:(...T)=>ll(e,r,i,T)},a.addFunction=Ct,a.removeFunction=Ke,a.UTF8ToString=Qe,a.ALLOC_NORMAL=zt,a.allocate=jt,a.allocateUTF8OnStack=on;function un(){function e(){var b;if(a.calledRun=!0,!H){if(!a.noFSInit&&!kn){var r,i;kn=!0,c??(c=a.stdin),r??(r=a.stdout),i??(i=a.stderr),c?Ye("stdin",c):en("/dev/tty","/dev/stdin"),r?Ye("stdout",null,r):en("/dev/tty","/dev/stdout"),i?Ye("stderr",null,i):en("/dev/tty1","/dev/stderr"),bt("/dev/stdin",0),bt("/dev/stdout",1),bt("/dev/stderr",1)}if(Z.N(),Tn=!1,(b=a.onRuntimeInitialized)==null||b.call(a),a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;){var c=a.postRun.shift();te.unshift(c)}x(te)}}if(0<oe)we=un;else{if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)X();x(O),0<oe?we=un:a.setStatus?(a.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>a.setStatus(""),1),e()},1)):e()}}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);0<a.preInit.length;)a.preInit.pop()();return un(),d}),n)};l.exports=o,l.exports.default=o})(Wr);var ro=Wr.exports;const lo=xl(ro);class oo{constructor(){this.db=null,this.sqlJs=null}async initialize(){if(!this.sqlJs){const n=window.location.protocol==="http:"?"/node_modules/sql.js/dist/sql-wasm.wasm":"./sql-wasm.wasm";this.sqlJs=await lo({locateFile:o=>n})}}async loadFromFile(t,n){await this.initialize();try{const o=await n.readDatabase(t);if(o){const s=new Uint8Array(o);this.db=new this.sqlJs.Database(s)}else this.db=new this.sqlJs.Database;return!0}catch(o){return console.error("Error loading database:",o),this.db=new this.sqlJs.Database,!1}}createNew(){if(!this.sqlJs)throw new Error("SQL.js not initialized");this.db=new this.sqlJs.Database}createTable(t,n){if(!this.db)throw new Error("Database not initialized");const o=n.map(u=>{let f;return u.type==="number"?f="REAL":u.type==="boolean"?f="INTEGER":f="TEXT",`"${u.name}" ${f}`}).join(", "),s=`CREATE TABLE "${t}" (${o})`;this.db.run(s)}insertData(t,n,o){if(!this.db)throw new Error("Database not initialized");if(o.length===0)return;const s=n.map(m=>`"${m.name}"`).join(", "),u=n.map(()=>"?").join(", "),f=`INSERT INTO "${t}" (${s}) VALUES (${u})`,d=this.db.prepare(f);for(const m of o){const a=n.map(p=>{const g=m[p.name];return g==null?null:p.type==="boolean"?g?1:0:g});d.run(a)}d.free()}getTableNames(){if(!this.db)return[];const t=this.db.exec("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%'");if(t.length===0)return[];const n=[];for(const o of t[0].values)n.push(o[0]);return n}getTableData(t,n=1e3,o=0){if(!this.db)return{columns:[],rows:[]};const s=this.db.exec(`SELECT rowid, * FROM "${t}" ORDER BY rowid ASC LIMIT ${n} OFFSET ${o}`);if(s.length===0)return{columns:[],rows:[]};const u=s[0].columns,f=u.filter(m=>m!=="rowid"),d=s[0].values.map(m=>{const a={};return u.forEach((p,g)=>{a[p]=m[g]}),a});return{columns:f,rows:d}}getAllTableData(t){if(!this.db)return{columns:[],rows:[]};const n=this.db.exec(`SELECT * FROM "${t}"`);if(n.length===0)return{columns:[],rows:[]};const o=n[0].columns,s=n[0].values.map(u=>{const f={};return o.forEach((d,m)=>{f[d]=u[m]}),f});return{columns:o,rows:s}}getTableRowCount(t){if(!this.db)return 0;const n=this.db.exec(`SELECT COUNT(*) as count FROM "${t}"`);return n.length===0?0:n[0].values[0][0]}async saveToFile(t,n){if(!this.db)throw new Error("Database not initialized");const o=this.db.export(),s=Array.from(o);await n.writeDatabase(t,s)}deleteTable(t){if(!this.db)throw new Error("Database not initialized");this.db.run(`DROP TABLE IF EXISTS "${t}"`)}executeSQL(t){if(!this.db)throw new Error("Database not initialized");try{if(t.trim().toUpperCase().startsWith("SELECT")){const o=this.db.exec(t);if(o.length===0)return{type:"select",columns:[],rows:[],rowCount:0};const s=o[0].columns,u=o[0].values.map(f=>{const d={};return s.forEach((m,a)=>{d[m]=f[a]}),d});return{type:"select",columns:s,rows:u,rowCount:u.length}}else{this.db.run(t);const o=this.db.exec("SELECT changes() as count");return{type:"modify",affectedRows:o.length>0?o[0].values[0][0]:0}}}catch(n){throw new Error(`SQL execution error: ${n.message}`)}}getTableSchema(t){if(!this.db)return[];try{const n=this.db.exec(`PRAGMA table_info("${t}")`);return n.length===0?[]:n[0].values.map(o=>({name:o[1],type:o[2],notnull:o[3],defaultValue:o[4],pk:o[5]}))}catch(n){return console.error("Error getting table schema:",n),[]}}deleteRow(t,n){if(!this.db)throw new Error("Database not initialized");try{const o=`DELETE FROM "${t}" WHERE rowid = ?`,s=this.db.prepare(o);return s.run([n]),s.free(),!0}catch(o){throw new Error(`Error deleting row: ${o.message}`)}}updateRow(t,n,o,s){if(!this.db)throw new Error("Database not initialized");try{const u=Object.keys(o).filter(g=>g!=="rowid"),f=u.map(g=>`"${g}" = ?`).join(", "),d=`UPDATE "${t}" SET ${f} WHERE rowid = ?`,m=this.db.prepare(d),a={};s&&s.forEach(g=>{a[g.name]=g});const p=u.map(g=>{const w=o[g];if(w==null||w==="")return null;const S=a[g];return S&&S.type==="INTEGER"&&(w===!0||w===!1||w==="true"||w==="false")?w===!0||w==="true"?1:0:w});return p.push(n),m.run(p),m.free(),!0}catch(u){throw new Error(`Error updating row: ${u.message}`)}}insertRow(t,n,o,s="end"){if(!this.db)throw new Error("Database not initialized");try{const u={...n};delete u.rowid;const f=Object.keys(u),d=f.map(g=>`"${g}"`).join(", "),m=f.map(()=>"?").join(", "),a={};o&&o.forEach(g=>{a[g.name]=g});const p=f.map(g=>{const w=u[g];if(w==null||w==="")return null;const S=a[g];return S&&S.type==="INTEGER"&&(w===!0||w===!1||w==="true"||w==="false")?w===!0||w==="true"?1:0:w});if(s==="beginning")this.insertRowAtBeginning(t,f,p,o);else{const g=`INSERT INTO "${t}" (${d}) VALUES (${m})`,w=this.db.prepare(g);w.run(p),w.free()}return!0}catch(u){throw new Error(`Error inserting row: ${u.message}`)}}insertRowAtBeginning(t,n,o,s){const u=`_temp_${t}_${Date.now()}`;try{const f=this.db.exec(`PRAGMA table_info("${t}")`);if(f.length===0)throw new Error("Table not found");const d=`CREATE TABLE "${u}" AS SELECT * FROM "${t}" WHERE 1=0`;this.db.run(d);const m=n.map(_=>`"${_}"`).join(", "),a=n.map(()=>"?").join(", "),p=`INSERT INTO "${u}" (${m}) VALUES (${a})`,g=this.db.prepare(p);g.run(o),g.free();const S=f[0].values.map(_=>_[1]).map(_=>`"${_}"`).join(", "),C=`INSERT INTO "${u}" (${S}) SELECT ${S} FROM "${t}" ORDER BY rowid ASC`;this.db.run(C),this.db.run(`DROP TABLE "${t}"`),this.db.run(`ALTER TABLE "${u}" RENAME TO "${t}"`)}catch(f){try{this.db.run(`DROP TABLE IF EXISTS "${u}"`)}catch{}throw f}}close(){this.db&&(this.db.close(),this.db=null)}}class io{constructor(t){this.api=t,this.logPath=null}async initialize(){this.logPath=await this.api.getDefaultLogPath()}getLogPath(){return this.logPath}async loadLog(){try{return await this.api.readLogFile(this.logPath)||""}catch(t){return console.error("Error loading log file:",t),""}}async saveLog(t){try{return await this.api.writeLogFile(this.logPath,t),!0}catch(n){return console.error("Error saving log file:",n),!1}}parseLogEntries(t){if(!t||t.trim()==="")return[];const n=t.split(`
`),o=[];let s=null;for(let u=0;u<n.length;u++){const f=n[u].trim(),d=f.match(/^\[(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})\]/);d?(s&&o.push(s),s={timestamp:d[1],lineNumber:u+1,naturalLanguage:"",sql:"",error:null,result:null}):s&&(f.startsWith("NL:")?s.naturalLanguage=f.substring(3).trim():f.startsWith("SQL:")?s.sql=f.substring(4).trim():f.startsWith("ERROR:")?s.error=f.substring(6).trim():f.startsWith("RESULT:")?s.result=f.substring(7).trim():f&&!f.startsWith("---")&&(s.sql&&!s.error&&!s.result?s.sql+=" "+f:s.error&&!s.result?s.error+=" "+f:s.result?s.result+=" "+f:!s.naturalLanguage&&!s.sql&&(s.naturalLanguage=f)))}return s&&o.push(s),o}formatLogEntry(t){let n=`[${t.timestamp}]
`;return t.naturalLanguage&&(n+=`NL: ${t.naturalLanguage}
`),t.sql&&(n+=`SQL: ${t.sql}
`),t.error&&(n+=`ERROR: ${t.error}
`),t.result&&(n+=`RESULT: ${t.result}
`),n+=`---
`,n}}class nr{static parseSchemaLine(t){const n=[],o=t.split(","),s=["string","number","boolean"];for(const u of o){const f=u.trim();if(!f)continue;const d=f.indexOf(":");if(d>0){const m=f.substring(0,d).trim(),a=f.substring(d+1).trim().toLowerCase();if(!s.includes(a))throw new Error(`Invalid column type modifier "${a}" for column "${m}". Valid types are: string, number, boolean`);n.push({name:m,type:a})}else n.push({name:f,type:"string"})}return n}static parseCSV(t){const n=t.split(/\r?\n/).filter(u=>u.trim());if(n.length===0)throw new Error("CSV file is empty");const o=this.parseSchemaLine(n[0]),s=[];for(let u=1;u<n.length;u++){const f=this.parseCSVLine(n[u]),d={};o.forEach((m,a)=>{let p=f[a]||"";if(p=p.trim(),m.type==="number")d[m.name]=p===""?null:parseFloat(p),isNaN(d[m.name])&&(d[m.name]=null);else if(m.type==="boolean"){const g=p.toLowerCase();d[m.name]=g==="true"||g==="1"||g==="yes"||g==="y"}else d[m.name]=p}),s.push(d)}return{schema:o,data:s}}static parseCSVLine(t){const n=[];let o="",s=!1;for(let u=0;u<t.length;u++){const f=t[u];f==='"'?s&&t[u+1]==='"'?(o+='"',u++):s=!s:f===","&&!s?(n.push(o),o=""):o+=f}return n.push(o),n}static getTableNameFromPath(t){return t.split(/[/\\]/).pop().replace(/\.csv$/i,"").replace(/[^a-zA-Z0-9_]/g,"_")}}class bn{static sqliteTypeToCsvType(t,n,o=[]){const s=t.toUpperCase();if(s==="TEXT")return"string";if(s==="REAL")return"number";if(s==="INTEGER"){if(o.length>0&&o.every(a=>a==null||a===0||a===1||a==="0"||a==="1"||a===!0||a===!1))return"boolean";const u=n.toLowerCase();return["active","enabled","is","has","can","should","flag","bool"].some(m=>u.startsWith(m)||u.includes("_"+m)||u.includes(m+"_"))?"boolean":"number"}return"string"}static formatValue(t,n){if(t==null)return"";if(n==="boolean")return t===0||t==="0"?"false":t===1||t==="1"||t?"true":"false";const o=String(t);return o.includes(",")||o.includes('"')||o.includes(`
`)||o.includes("\r")?`"${o.replace(/"/g,'""')}"`:o}static exportTableToCSV(t,n,o){if(!n||n.length===0)throw new Error("Table schema is required");if(!o||!o.rows||o.rows.length===0)return n.map(p=>{const g=this.sqliteTypeToCsvType(p.type,p.name,[]);return`${p.name}:${g}`}).join(", ")+`
`;const s=o.rows.slice(0,10),u={};n.forEach(a=>{u[a.name]=s.map(p=>p[a.name])});let m=n.map(a=>{const p=this.sqliteTypeToCsvType(a.type,a.name,u[a.name]||[]);return`${a.name}:${p}`}).join(", ")+`
`;for(const a of o.rows){const p=n.map(g=>{const w=this.sqliteTypeToCsvType(g.type,g.name,u[g.name]||[]);return this.formatValue(a[g.name],w)});m+=p.join(",")+`
`}return m}}function rr(l,t,n){const o=l.slice();return o[6]=t[n],o}function lr(l,t,n){const o=l.slice();return o[9]=t[n],o}function or(l,t,n){const o=l.slice();return o[9]=t[n],o}function ir(l){let t,n=l[9]+"",o;return{c(){t=E("th"),o=V(n),v(t,"class","svelte-ksfv4t")},m(s,u){Q(s,t,u),h(t,o)},p(s,u){u&1&&n!==(n=s[9]+"")&&fe(o,n)},d(s){s&&U(t)}}}function sr(l){let t,n=(l[6][l[9]]??"")+"",o;return{c(){t=E("td"),o=V(n),v(t,"class","svelte-ksfv4t")},m(s,u){Q(s,t,u),h(t,o)},p(s,u){u&1&&n!==(n=(s[6][s[9]]??"")+"")&&fe(o,n)},d(s){s&&U(t)}}}function ar(l){let t,n,o,s,u,f,d,m,a,p=Pe(l[0].columns),g=[];for(let C=0;C<p.length;C+=1)g[C]=sr(lr(l,p,C));function w(){return l[3](l[6])}function S(){return l[4](l[6])}return{c(){t=E("tr");for(let C=0;C<g.length;C+=1)g[C].c();n=F(),o=E("td"),s=E("button"),s.textContent="",u=F(),f=E("button"),f.textContent="",d=F(),v(s,"class","action-button edit-button svelte-ksfv4t"),v(s,"title","Edit row"),v(f,"class","action-button delete-button svelte-ksfv4t"),v(f,"title","Delete row"),v(o,"class","actions-cell svelte-ksfv4t"),v(t,"class","svelte-ksfv4t")},m(C,_){Q(C,t,_);for(let y=0;y<g.length;y+=1)g[y]&&g[y].m(t,null);h(t,n),h(t,o),h(o,s),h(o,u),h(o,f),h(t,d),m||(a=[me(s,"click",w),me(f,"click",S)],m=!0)},p(C,_){if(l=C,_&1){p=Pe(l[0].columns);let y;for(y=0;y<p.length;y+=1){const P=lr(l,p,y);g[y]?g[y].p(P,_):(g[y]=sr(P),g[y].c(),g[y].m(t,n))}for(;y<g.length;y+=1)g[y].d(1);g.length=p.length}},d(C){C&&U(t),ft(g,C),m=!1,Me(a)}}}function so(l){let t,n,o,s,u,f,d,m,a=Pe(l[0].columns),p=[];for(let S=0;S<a.length;S+=1)p[S]=ir(or(l,a,S));let g=Pe(l[0].rows),w=[];for(let S=0;S<g.length;S+=1)w[S]=ar(rr(l,g,S));return{c(){t=E("div"),n=E("table"),o=E("thead"),s=E("tr");for(let S=0;S<p.length;S+=1)p[S].c();u=F(),f=E("th"),f.textContent="Actions",d=F(),m=E("tbody");for(let S=0;S<w.length;S+=1)w[S].c();v(f,"class","actions-header svelte-ksfv4t"),v(s,"class","svelte-ksfv4t"),v(o,"class","svelte-ksfv4t"),v(n,"class","data-table svelte-ksfv4t"),v(t,"class","table-container svelte-ksfv4t")},m(S,C){Q(S,t,C),h(t,n),h(n,o),h(o,s);for(let _=0;_<p.length;_+=1)p[_]&&p[_].m(s,null);h(s,u),h(s,f),h(n,d),h(n,m);for(let _=0;_<w.length;_+=1)w[_]&&w[_].m(m,null)},p(S,[C]){if(C&1){a=Pe(S[0].columns);let _;for(_=0;_<a.length;_+=1){const y=or(S,a,_);p[_]?p[_].p(y,C):(p[_]=ir(y),p[_].c(),p[_].m(s,u))}for(;_<p.length;_+=1)p[_].d(1);p.length=a.length}if(C&7){g=Pe(S[0].rows);let _;for(_=0;_<g.length;_+=1){const y=rr(S,g,_);w[_]?w[_].p(y,C):(w[_]=ar(y),w[_].c(),w[_].m(m,null))}for(;_<w.length;_+=1)w[_].d(1);w.length=g.length}},i:ge,o:ge,d(S){S&&U(t),ft(p,S),ft(w,S)}}}function ao(l,t,n){let{tableData:o={columns:[],rows:[]}}=t;const s=yt();function u(a){s("edit",a)}function f(a){confirm("Are you sure you want to delete this row?")&&s("delete",a)}const d=a=>u(a),m=a=>f(a);return l.$$set=a=>{"tableData"in a&&n(0,o=a.tableData)},[o,u,f,d,m]}class uo extends nt{constructor(t){super(),tt(this,t,ao,so,$e,{tableData:0})}}function ur(l,t,n){const o=l.slice();o[22]=t[n];const s=o[7](o[22]);o[23]=s;const u=o[1].find(function(...a){return l[18](o[22],...a)});o[24]=u;const f=o[24]&&o[24].notnull;o[25]=f;const d=po(o[4][o[22]],o[23]);return o[26]=d,o}function fr(l){let t,n,o,s,u=l[2]?"Edit Row":"Add New Row",f,d,m,a,p,g,w,S,C,_,y,P,D,$,B=!l[2]&&cr(l),re=Pe(l[0]),W=[];for(let I=0;I<re.length;I+=1)W[I]=mr(ur(l,re,I));return{c(){t=E("div"),n=E("div"),o=E("div"),s=E("h3"),f=V(u),d=F(),m=E("button"),m.textContent="",a=F(),p=E("div"),g=E("form"),B&&B.c(),w=F();for(let I=0;I<W.length;I+=1)W[I].c();S=F(),C=E("div"),_=E("button"),_.textContent="Cancel",y=F(),P=E("button"),P.textContent="Save",v(s,"class","svelte-16p8pqs"),v(m,"class","close-button svelte-16p8pqs"),v(o,"class","modal-header svelte-16p8pqs"),v(p,"class","modal-body svelte-16p8pqs"),v(_,"class","button button-secondary svelte-16p8pqs"),v(P,"class","button button-primary svelte-16p8pqs"),v(C,"class","modal-footer svelte-16p8pqs"),v(n,"class","modal-content svelte-16p8pqs"),v(n,"role","document"),v(t,"class","modal-overlay svelte-16p8pqs"),v(t,"role","dialog"),v(t,"aria-modal","true")},m(I,H){Q(I,t,H),h(t,n),h(n,o),h(o,s),h(s,f),h(o,d),h(o,m),h(n,a),h(n,p),h(p,g),B&&B.m(g,null),h(g,w);for(let A=0;A<W.length;A+=1)W[A]&&W[A].m(g,null);h(n,S),h(n,C),h(C,_),h(C,y),h(C,P),D||($=[me(m,"click",l[10]),me(g,"submit",Fl(l[9])),me(_,"click",l[10]),me(P,"click",l[9]),me(n,"click",zl(l[11])),me(t,"click",l[10]),me(t,"keydown",l[19])],D=!0)},p(I,H){if(H&4&&u!==(u=I[2]?"Edit Row":"Add New Row")&&fe(f,u),I[2]?B&&(B.d(1),B=null):B?B.p(I,H):(B=cr(I),B.c(),B.m(g,w)),H&435){re=Pe(I[0]);let A;for(A=0;A<re.length;A+=1){const z=ur(I,re,A);W[A]?W[A].p(z,H):(W[A]=mr(z),W[A].c(),W[A].m(g,null))}for(;A<W.length;A+=1)W[A].d(1);W.length=re.length}},d(I){I&&U(t),B&&B.d(),ft(W,I),D=!1,Me($)}}}function cr(l){let t,n,o,s,u,f,d,m,a,p,g,w,S,C,_,y;return C=jl(l[13][0]),{c(){t=E("div"),n=E("div"),n.textContent="Insert Position:",o=F(),s=E("div"),u=E("label"),f=E("input"),d=F(),m=E("span"),m.textContent="Insert at beginning (first row)",a=F(),p=E("label"),g=E("input"),w=F(),S=E("span"),S.textContent="Append at end (last row)",v(n,"class","radio-group-label svelte-16p8pqs"),v(f,"type","radio"),f.__value="beginning",ct(f,f.__value),v(f,"class","svelte-16p8pqs"),v(u,"class","radio-label svelte-16p8pqs"),v(g,"type","radio"),g.__value="end",ct(g,g.__value),v(g,"class","svelte-16p8pqs"),v(p,"class","radio-label svelte-16p8pqs"),v(s,"class","radio-group svelte-16p8pqs"),v(s,"role","radiogroup"),v(s,"aria-label","Insert Position"),v(t,"class","form-field insert-position-field svelte-16p8pqs"),C.p(f,g)},m(P,D){Q(P,t,D),h(t,n),h(t,o),h(t,s),h(s,u),h(u,f),f.checked=f.__value===l[6],h(u,d),h(u,m),h(s,a),h(s,p),h(p,g),g.checked=g.__value===l[6],h(p,w),h(p,S),_||(y=[me(f,"change",l[12]),me(g,"change",l[14])],_=!0)},p(P,D){D&64&&(f.checked=f.__value===P[6]),D&64&&(g.checked=g.__value===P[6])},d(P){P&&U(t),C.r(),_=!1,Me(y)}}}function dr(l){let t;return{c(){t=E("span"),t.textContent="*",v(t,"class","required svelte-16p8pqs")},m(n,o){Q(n,t,o)},d(n){n&&U(t)}}}function fo(l){let t,n,o,s,u;function f(...d){return l[17](l[22],l[23],...d)}return{c(){t=E("input"),v(t,"id",n="field-"+l[22]),v(t,"type","text"),v(t,"class","form-input svelte-16p8pqs"),t.value=o=l[26],vt(t,"error",l[5][l[22]])},m(d,m){Q(d,t,m),s||(u=me(t,"input",f),s=!0)},p(d,m){l=d,m&1&&n!==(n="field-"+l[22])&&v(t,"id",n),m&17&&o!==(o=l[26])&&t.value!==o&&(t.value=o),m&33&&vt(t,"error",l[5][l[22]])},d(d){d&&U(t),s=!1,u()}}}function co(l){let t,n,o,s,u,f;function d(...m){return l[16](l[22],l[23],...m)}return{c(){t=E("input"),v(t,"id",n="field-"+l[22]),v(t,"type","number"),v(t,"class","form-input svelte-16p8pqs"),t.value=o=l[26],v(t,"step",s=l[23]==="INTEGER"?"1":"any"),vt(t,"error",l[5][l[22]])},m(m,a){Q(m,t,a),u||(f=me(t,"input",d),u=!0)},p(m,a){l=m,a&1&&n!==(n="field-"+l[22])&&v(t,"id",n),a&17&&o!==(o=l[26])&&t.value!==o&&(t.value=o),a&1&&s!==(s=l[23]==="INTEGER"?"1":"any")&&v(t,"step",s),a&33&&vt(t,"error",l[5][l[22]])},d(m){m&&U(t),u=!1,f()}}}function ho(l){let t,n,o,s,u,f,d;function m(...a){return l[15](l[22],l[23],...a)}return{c(){t=E("select"),n=E("option"),n.textContent="False",o=E("option"),o.textContent="True",n.__value="false",ct(n,n.__value),o.__value="true",ct(o,o.__value),v(t,"id",s="field-"+l[22]),v(t,"class","form-input svelte-16p8pqs"),vt(t,"error",l[5][l[22]])},m(a,p){Q(a,t,p),h(t,n),h(t,o),Bt(t,l[26]),f||(d=me(t,"change",m),f=!0)},p(a,p){l=a,p&1&&s!==(s="field-"+l[22])&&v(t,"id",s),p&17&&u!==(u=l[26])&&Bt(t,l[26]),p&33&&vt(t,"error",l[5][l[22]])},d(a){a&&U(t),f=!1,d()}}}function hr(l){let t,n=l[5][l[22]]+"",o;return{c(){t=E("span"),o=V(n),v(t,"class","error-message svelte-16p8pqs")},m(s,u){Q(s,t,u),h(t,o)},p(s,u){u&33&&n!==(n=s[5][s[22]]+"")&&fe(o,n)},d(s){s&&U(t)}}}function mr(l){let t,n,o=l[22]+"",s,u,f,d,m,a,p=l[25]&&dr();function g(_,y){return _[23]==="BOOLEAN"?ho:_[23]==="NUMBER"||_[23]==="INTEGER"?co:fo}let w=g(l),S=w(l),C=l[5][l[22]]&&hr(l);return{c(){t=E("div"),n=E("label"),s=V(o),u=F(),p&&p.c(),d=F(),S.c(),m=F(),C&&C.c(),a=F(),v(n,"for",f="field-"+l[22]),v(n,"class","svelte-16p8pqs"),v(t,"class","form-field svelte-16p8pqs")},m(_,y){Q(_,t,y),h(t,n),h(n,s),h(n,u),p&&p.m(n,null),h(t,d),S.m(t,null),h(t,m),C&&C.m(t,null),h(t,a)},p(_,y){y&1&&o!==(o=_[22]+"")&&fe(s,o),_[25]?p||(p=dr(),p.c(),p.m(n,null)):p&&(p.d(1),p=null),y&1&&f!==(f="field-"+_[22])&&v(n,"for",f),w===(w=g(_))&&S?S.p(_,y):(S.d(1),S=w(_),S&&(S.c(),S.m(t,m))),_[5][_[22]]?C?C.p(_,y):(C=hr(_),C.c(),C.m(t,a)):C&&(C.d(1),C=null)},d(_){_&&U(t),p&&p.d(),S.d(),C&&C.d()}}}function mo(l){let t,n=l[3]&&fr(l);return{c(){n&&n.c(),t=gn()},m(o,s){n&&n.m(o,s),Q(o,t,s)},p(o,[s]){o[3]?n?n.p(o,s):(n=fr(o),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:ge,o:ge,d(o){o&&U(t),n&&n.d(o)}}}function po(l,t){return l==null?"":t==="BOOLEAN"?l===1||l===!0||l==="1"||l==="true":String(l)}function bo(l,t,n){let{columns:o=[]}=t,{schema:s=[]}=t,{rowData:u=null}=t,{open:f=!1}=t;const d=yt();let m={},a={},p="end";function g(A){const z=s.find(K=>K.name===A);if(!z)return"TEXT";const M=z.type.toUpperCase();if(M==="INTEGER"){const K=u?u[A]:null;return K===0||K===1||A.toLowerCase().includes("flag")||A.toLowerCase().includes("is")||A.toLowerCase().includes("has")?"BOOLEAN":"INTEGER"}else if(M==="REAL")return"NUMBER";return"TEXT"}function w(A,z,M){n(4,m[A]=z,m),a[A]&&(n(5,a={...a}),delete a[A],n(5,a),n(3,f),n(0,o),n(2,u))}function S(){n(5,a={});let A=!0;return o.forEach(z=>{const M=m[z],K=s.find(N=>N.name===z);K&&K.notnull&&(M==null||M==="")&&(n(5,a[z]="This field is required",a),A=!1);const R=g(z);if((R==="NUMBER"||R==="INTEGER")&&M!==""&&M!==null&&M!==void 0){const N=Number(M);isNaN(N)&&(n(5,a[z]="Must be a valid number",a),A=!1)}}),A}function C(){if(!S())return;const A={};o.forEach(z=>{const M=g(z);let K=m[z];K===""||K===null||K===void 0?A[z]=null:M==="BOOLEAN"?A[z]=K===!0||K==="true"||K===1||K==="1":M==="NUMBER"||M==="INTEGER"?A[z]=Number(K):A[z]=String(K)}),u&&u.rowid&&(A.rowid=u.rowid),d("save",{rowData:A,isEdit:!!u,insertPosition:u?null:p})}function _(){d("cancel")}const y=[[]];function P(A){Bl.call(this,l,A)}function D(){p=this.__value,n(6,p)}function $(){p=this.__value,n(6,p)}const B=(A,z,M)=>w(A,M.target.value==="true",z),re=(A,z,M)=>w(A,M.target.value,z),W=(A,z,M)=>w(A,M.target.value,z),I=(A,z)=>z.name===A,H=A=>A.key==="Escape"&&_();return l.$$set=A=>{"columns"in A&&n(0,o=A.columns),"schema"in A&&n(1,s=A.schema),"rowData"in A&&n(2,u=A.rowData),"open"in A&&n(3,f=A.open)},l.$$.update=()=>{l.$$.dirty&13&&f&&o.length>0&&(u?(n(4,m={}),o.forEach(A=>{n(4,m[A]=u[A]??"",m)})):(n(4,m={}),o.forEach(A=>{n(4,m[A]="",m)})),n(5,a={}))},[o,s,u,f,m,a,p,g,w,C,_,P,D,y,$,B,re,W,I,H]}class go extends nt{constructor(t){super(),tt(this,t,bo,mo,$e,{columns:0,schema:1,rowData:2,open:3})}}function pr(l,t,n){const o=l.slice();return o[32]=t[n],o}function _o(l){let t,n=Pe(l[0]),o=[];for(let s=0;s<n.length;s+=1)o[s]=br(pr(l,n,s));return{c(){for(let s=0;s<o.length;s+=1)o[s].c();t=gn()},m(s,u){for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(s,u);Q(s,t,u)},p(s,u){if(u[0]&1){n=Pe(s[0]);let f;for(f=0;f<n.length;f+=1){const d=pr(s,n,f);o[f]?o[f].p(d,u):(o[f]=br(d),o[f].c(),o[f].m(t.parentNode,t))}for(;f<o.length;f+=1)o[f].d(1);o.length=n.length}},d(s){s&&U(t),ft(o,s)}}}function wo(l){let t;return{c(){t=E("option"),t.textContent="No tables available",t.__value="",ct(t,t.__value)},m(n,o){Q(n,t,o)},p:ge,d(n){n&&U(t)}}}function br(l){let t,n=l[32]+"",o,s;return{c(){t=E("option"),o=V(n),t.__value=s=l[32],ct(t,t.__value)},m(u,f){Q(u,t,f),h(t,o)},p(u,f){f[0]&1&&n!==(n=u[32]+"")&&fe(o,n),f[0]&1&&s!==(s=u[32])&&(t.__value=s,ct(t,t.__value))},d(u){u&&U(t)}}}function gr(l){let t,n,o=l[4].size+"",s,u,f,d;return{c(){t=E("button"),n=V("Update ("),s=V(o),u=V(")"),v(t,"class","update-button svelte-18dj43o"),v(t,"title","Save modified tables to CSV files and restart")},m(m,a){Q(m,t,a),h(t,n),h(t,s),h(t,u),f||(d=me(t,"click",l[18]),f=!0)},p(m,a){a[0]&16&&o!==(o=m[4].size+"")&&fe(s,o)},d(m){m&&U(t),f=!1,d()}}}function _r(l){let t,n,o,s,u,f=l[10]?"Exporting...":"Export CSV",d,m,a,p;return{c(){t=E("button"),n=V("+ Add Row"),s=F(),u=E("button"),d=V(f),v(t,"class","add-row-button svelte-18dj43o"),v(t,"title","Add new row"),t.disabled=o=l[9]||!l[3],v(u,"class","export-button svelte-18dj43o"),v(u,"title","Export table to CSV"),u.disabled=m=l[10]||l[9]||!l[3]},m(g,w){Q(g,t,w),h(t,n),Q(g,s,w),Q(g,u,w),h(u,d),a||(p=[me(t,"click",l[22]),me(u,"click",l[21])],a=!0)},p(g,w){w[0]&520&&o!==(o=g[9]||!g[3])&&(t.disabled=o),w[0]&1024&&f!==(f=g[10]?"Exporting...":"Export CSV")&&fe(d,f),w[0]&1544&&m!==(m=g[10]||g[9]||!g[3])&&(u.disabled=m)},d(g){g&&(U(t),U(s),U(u)),a=!1,Me(p)}}}function vo(l){let t;return{c(){t=E("div"),t.textContent="Select a table to view",v(t,"class","empty-message svelte-18dj43o")},m(n,o){Q(n,t,o)},p:ge,i:ge,o:ge,d(n){n&&U(t)}}}function yo(l){let t,n,o=l[3]&&wr(l);return{c(){t=E("div"),n=V(`Table is empty
        `),o&&o.c(),v(t,"class","empty-message svelte-18dj43o")},m(s,u){Q(s,t,u),h(t,n),o&&o.m(t,null)},p(s,u){s[3]?o?o.p(s,u):(o=wr(s),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},i:ge,o:ge,d(s){s&&U(t),o&&o.d()}}}function Eo(l){let t,n,o,s,u,f,d,m,a,p,g,w,S,C,_,y=l[6]+1+"",P,D,$,B=l[7]+1+"",re,W,I,H,A,z,M,K,R,N,le,pe=l[6]*Xe+1+"",se,ae,J=Math.min((l[6]+1)*Xe,l[5])+"",oe,we,ve,qe,Te,Ce,De,Ee,x,te,O=l[2][l[1]]&&vr(l);return I=new uo({props:{tableData:l[8]}}),I.$on("edit",l[23]),I.$on("delete",l[24]),{c(){t=E("div"),n=E("span"),o=V("Table: "),s=E("strong"),u=V(l[1]),f=F(),O&&O.c(),d=F(),m=E("span"),a=V("Rows: "),p=E("strong"),g=V(l[5]),w=F(),S=E("span"),C=V("Page: "),_=E("strong"),P=V(y),D=V(" of "),$=E("strong"),re=V(B),W=F(),dt(I.$$.fragment),H=F(),A=E("div"),z=E("button"),M=V(" Previous"),R=F(),N=E("span"),le=V("Showing "),se=V(pe),ae=V(" - "),oe=V(J),we=V(" of "),ve=V(l[5]),qe=F(),Te=E("button"),Ce=V("Next "),v(s,"class","svelte-18dj43o"),v(p,"class","svelte-18dj43o"),v(_,"class","svelte-18dj43o"),v($,"class","svelte-18dj43o"),v(t,"class","table-info svelte-18dj43o"),v(z,"class","page-button svelte-18dj43o"),z.disabled=K=!l[15],v(N,"class","page-info svelte-18dj43o"),v(Te,"class","page-button svelte-18dj43o"),Te.disabled=De=!l[14],v(A,"class","pagination svelte-18dj43o")},m(X,ne){Q(X,t,ne),h(t,n),h(n,o),h(n,s),h(s,u),h(t,f),O&&O.m(t,null),h(t,d),h(t,m),h(m,a),h(m,p),h(p,g),h(t,w),h(t,S),h(S,C),h(S,_),h(_,P),h(S,D),h(S,$),h($,re),Q(X,W,ne),xe(I,X,ne),Q(X,H,ne),Q(X,A,ne),h(A,z),h(z,M),h(A,R),h(A,N),h(N,le),h(N,se),h(N,ae),h(N,oe),h(N,we),h(N,ve),h(A,qe),h(A,Te),h(Te,Ce),Ee=!0,x||(te=[me(z,"click",l[19]),me(Te,"click",l[20])],x=!0)},p(X,ne){(!Ee||ne[0]&2)&&fe(u,X[1]),X[2][X[1]]?O?O.p(X,ne):(O=vr(X),O.c(),O.m(t,d)):O&&(O.d(1),O=null),(!Ee||ne[0]&32)&&fe(g,X[5]),(!Ee||ne[0]&64)&&y!==(y=X[6]+1+"")&&fe(P,y),(!Ee||ne[0]&128)&&B!==(B=X[7]+1+"")&&fe(re,B);const Se={};ne[0]&256&&(Se.tableData=X[8]),I.$set(Se),(!Ee||ne[0]&32768&&K!==(K=!X[15]))&&(z.disabled=K),(!Ee||ne[0]&64)&&pe!==(pe=X[6]*Xe+1+"")&&fe(se,pe),(!Ee||ne[0]&96)&&J!==(J=Math.min((X[6]+1)*Xe,X[5])+"")&&fe(oe,J),(!Ee||ne[0]&32)&&fe(ve,X[5]),(!Ee||ne[0]&16384&&De!==(De=!X[14]))&&(Te.disabled=De)},i(X){Ee||(Ae(I.$$.fragment,X),Ee=!0)},o(X){Oe(I.$$.fragment,X),Ee=!1},d(X){X&&(U(t),U(W),U(H),U(A)),O&&O.d(),et(I,X),x=!1,Me(te)}}}function ko(l){let t;return{c(){t=E("div"),t.textContent="Loading table data...",v(t,"class","loading-message svelte-18dj43o")},m(n,o){Q(n,t,o)},p:ge,i:ge,o:ge,d(n){n&&U(t)}}}function wr(l){let t,n,o;return{c(){t=E("button"),t.textContent="+ Add First Row",v(t,"class","add-row-button svelte-18dj43o"),Ul(t,"margin-top","16px")},m(s,u){Q(s,t,u),n||(o=me(t,"click",l[22]),n=!0)},p:ge,d(s){s&&U(t),n=!1,o()}}}function vr(l){let t,n,o,s=l[2][l[1]].split(/[/\\]/).pop()+"",u;return{c(){t=E("span"),n=V("Source: "),o=E("strong"),u=V(s),v(o,"class","svelte-18dj43o")},m(f,d){Q(f,t,d),h(t,n),h(t,o),h(o,u)},p(f,d){d[0]&6&&s!==(s=f[2][f[1]].split(/[/\\]/).pop()+"")&&fe(u,s)},d(f){f&&U(t)}}}function yr(l){let t,n;return t=new go({props:{columns:l[8].columns,schema:l[13],rowData:l[12],open:l[11]}}),t.$on("save",l[25]),t.$on("cancel",l[26]),{c(){dt(t.$$.fragment)},m(o,s){xe(t,o,s),n=!0},p(o,s){const u={};s[0]&256&&(u.columns=o[8].columns),s[0]&8192&&(u.schema=o[13]),s[0]&4096&&(u.rowData=o[12]),s[0]&2048&&(u.open=o[11]),t.$set(u)},i(o){n||(Ae(t.$$.fragment,o),n=!0)},o(o){Oe(t.$$.fragment,o),n=!1},d(o){et(t,o)}}}function To(l){let t,n,o,s,u,f,d,m,a,p,g,w,S,C,_,y,P,D,$,B;function re(N,le){return N[0].length===0?wo:_o}let W=re(l),I=W(l),H=l[4].size>0&&gr(l),A=l[1]&&l[3]&&_r(l);const z=[ko,Eo,yo,vo],M=[];function K(N,le){return N[9]?0:N[1]&&N[8].columns.length>0?1:N[1]?2:3}_=K(l),y=M[_]=z[_](l);let R=l[11]&&l[1]&&yr(l);return{c(){t=E("div"),n=E("header"),o=E("div"),s=E("h2"),s.textContent="Database Tables",u=F(),f=E("select"),I.c(),m=F(),a=E("div"),H&&H.c(),p=F(),A&&A.c(),g=F(),w=E("button"),w.textContent="",S=F(),C=E("div"),y.c(),P=F(),R&&R.c(),v(s,"class","svelte-18dj43o"),v(f,"class","table-selector svelte-18dj43o"),v(o,"class","header-left svelte-18dj43o"),v(w,"class","refresh-button svelte-18dj43o"),v(w,"title","Refresh"),v(a,"class","header-right svelte-18dj43o"),v(n,"class","viewer-header svelte-18dj43o"),v(C,"class","viewer-content svelte-18dj43o"),v(t,"class","table-viewer svelte-18dj43o")},m(N,le){Q(N,t,le),h(t,n),h(n,o),h(o,s),h(o,u),h(o,f),I.m(f,null),Bt(f,l[1]||""),h(n,m),h(n,a),H&&H.m(a,null),h(a,p),A&&A.m(a,null),h(a,g),h(a,w),h(t,S),h(t,C),M[_].m(C,null),h(t,P),R&&R.m(t,null),D=!0,$||(B=[me(f,"change",l[16]),me(w,"click",l[17])],$=!0)},p(N,le){W===(W=re(N))&&I?I.p(N,le):(I.d(1),I=W(N),I&&(I.c(),I.m(f,null))),(!D||le[0]&3&&d!==(d=N[1]||""))&&Bt(f,N[1]||""),N[4].size>0?H?H.p(N,le):(H=gr(N),H.c(),H.m(a,p)):H&&(H.d(1),H=null),N[1]&&N[3]?A?A.p(N,le):(A=_r(N),A.c(),A.m(a,g)):A&&(A.d(1),A=null);let pe=_;_=K(N),_===pe?M[_].p(N,le):(mn(),Oe(M[pe],1,1,()=>{M[pe]=null}),pn(),y=M[_],y?y.p(N,le):(y=M[_]=z[_](N),y.c()),Ae(y,1),y.m(C,null)),N[11]&&N[1]?R?(R.p(N,le),le[0]&2050&&Ae(R,1)):(R=yr(N),R.c(),Ae(R,1),R.m(t,null)):R&&(mn(),Oe(R,1,1,()=>{R=null}),pn())},i(N){D||(Ae(y),Ae(R),D=!0)},o(N){Oe(y),Oe(R),D=!1},d(N){N&&U(t),I.d(),H&&H.d(),A&&A.d(),M[_].d(),R&&R.d(),$=!1,Me(B)}}}let Xe=100;function So(l,t,n){let o,s,u,{tables:f=[]}=t,{currentTable:d=null}=t,{dbManager:m=null}=t,{tableToCsvMap:a={}}=t,{electronAPI:p=null}=t,{modifiedTables:g=new Set}=t;const w=yt();let S={columns:[],rows:[]},C=0,_=0,y=!1,P=!1,D=!1,$=null,B=[];async function re(){if(!(!d||!m))try{n(13,B=m.getTableSchema(d))}catch(J){console.error("Error loading table schema:",J),n(13,B=[])}}async function W(){if(!(!d||!m)){n(9,y=!0);try{n(5,C=m.getTableRowCount(d));const J=_*Xe;n(8,S=m.getTableData(d,Xe,J))}catch(J){console.error("Error loading table data:",J)}finally{n(9,y=!1)}}}function I(J){const oe=J.target.value;oe&&(n(6,_=0),w("tableSelect",{table:oe}))}function H(){W(),w("refresh")}async function A(){w("updateAndRestart")}function z(){_>0&&(n(6,_--,_),W())}function M(){const J=Math.ceil(C/Xe)-1;_<J&&(n(6,_++,_),W())}async function K(){if(!(!d||!m||!p||P)){n(10,P=!0);try{const J=m.getTableSchema(d);if(!J||J.length===0){alert("Unable to get table schema");return}const oe=m.getAllTableData(d);if(!oe||oe.rows.length===0){alert("Table is empty, nothing to export");return}const we=bn.exportTableToCSV(d,J,oe),ve=await p.saveFile({title:"Export Table to CSV",defaultPath:`${d}.csv`,filters:[{name:"CSV Files",extensions:["csv"]}]});if(!ve)return;await p.writeCsvFile(ve,we),alert(`Table "${d}" exported successfully to ${ve}`)}catch(J){console.error("Error exporting table:",J),alert(`Error exporting table: ${J.message}`)}finally{n(10,P=!1)}}}function R(){n(12,$=null),n(11,D=!0)}function N(J){n(12,$=J.detail),n(11,D=!0)}function le(J){const oe=J.detail;if(!oe||!oe.rowid){alert("Error: Cannot identify row to delete");return}pe(oe.rowid)}async function pe(J){if(!(!d||!m))try{m.deleteRow(d,J);const oe=await p.getDefaultDatabasePath();await m.saveToFile(oe,p),await W(),w("refresh"),w("tableModified",{table:d}),alert("Row deleted successfully")}catch(oe){console.error("Error deleting row:",oe),alert(`Error deleting row: ${oe.message}`)}}async function se(J){const{rowData:oe,isEdit:we,insertPosition:ve}=J.detail;if(!(!d||!m))try{if(we){if(!oe.rowid){alert("Error: Cannot identify row to update");return}m.updateRow(d,oe.rowid,oe,B)}else{const Te=ve||"end";if(m.insertRow(d,oe,B,Te),Te==="beginning")n(6,_=0);else{const Ce=m.getTableRowCount(d),De=Math.ceil(Ce/Xe)-1;n(6,_=Math.max(0,De))}}const qe=await p.getDefaultDatabasePath();await m.saveToFile(qe,p),await W(),w("refresh"),w("tableModified",{table:d}),n(11,D=!1),n(12,$=null),alert(we?"Row updated successfully":"Row added successfully")}catch(qe){console.error("Error saving row:",qe),alert(`Error saving row: ${qe.message}`)}}function ae(){n(11,D=!1),n(12,$=null)}return l.$$set=J=>{"tables"in J&&n(0,f=J.tables),"currentTable"in J&&n(1,d=J.currentTable),"dbManager"in J&&n(27,m=J.dbManager),"tableToCsvMap"in J&&n(2,a=J.tableToCsvMap),"electronAPI"in J&&n(3,p=J.electronAPI),"modifiedTables"in J&&n(4,g=J.modifiedTables)},l.$$.update=()=>{l.$$.dirty[0]&134217730&&d&&m&&(W(),re()),l.$$.dirty[0]&10&&d&&console.log("Current table set:",d,"electronAPI available:",!!p),l.$$.dirty[0]&32&&n(7,o=Math.ceil(C/Xe)-1),l.$$.dirty[0]&64&&n(15,s=_>0),l.$$.dirty[0]&192&&n(14,u=_<o)},[f,d,a,p,g,C,_,o,S,y,P,D,$,B,u,s,I,H,A,z,M,K,R,N,le,se,ae,m]}class Co extends nt{constructor(t){super(),tt(this,t,So,To,$e,{tables:0,currentTable:1,dbManager:27,tableToCsvMap:2,electronAPI:3,modifiedTables:4},null,[-1,-1])}}function qo(l){let t,n,o,s,u;return{c(){t=E("div"),n=E("div"),o=F(),s=E("p"),u=V(l[0]),v(n,"class","spinner svelte-1ywxz8e"),v(s,"class","message svelte-1ywxz8e"),v(t,"class","loading-container svelte-1ywxz8e")},m(f,d){Q(f,t,d),h(t,n),h(t,o),h(t,s),h(s,u)},p(f,[d]){d&1&&fe(u,f[0])},i:ge,o:ge,d(f){f&&U(t)}}}function Ao(l,t,n){let{message:o="Loading..."}=t;return l.$$set=s=>{"message"in s&&n(0,o=s.message)},[o]}class Po extends nt{constructor(t){super(),tt(this,t,Ao,qo,$e,{message:0})}}function Er(l,t,n){const o=l.slice();return o[7]=t[n],o}function Lo(l){let t;return{c(){t=E("p"),t.textContent="No CSV files specified",v(t,"class","no-files svelte-fu6li4")},m(n,o){Q(n,t,o)},p:ge,d(n){n&&U(t)}}}function No(l){let t,n=Pe(l[0].csvFiles),o=[];for(let s=0;s<n.length;s+=1)o[s]=kr(Er(l,n,s));return{c(){t=E("ul");for(let s=0;s<o.length;s+=1)o[s].c();v(t,"class","svelte-fu6li4")},m(s,u){Q(s,t,u);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(t,null)},p(s,u){if(u&1){n=Pe(s[0].csvFiles);let f;for(f=0;f<n.length;f+=1){const d=Er(s,n,f);o[f]?o[f].p(d,u):(o[f]=kr(d),o[f].c(),o[f].m(t,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=n.length}},d(s){s&&U(t),ft(o,s)}}}function kr(l){let t,n,o=l[7]+"",s;return{c(){t=E("li"),n=E("code"),s=V(o),v(n,"class","svelte-fu6li4"),v(t,"class","svelte-fu6li4")},m(u,f){Q(u,t,f),h(t,n),h(n,s)},p(u,f){f&1&&o!==(o=u[7]+"")&&fe(s,o)},d(u){u&&U(t)}}}function Ro(l){var De,Ee,x;let t,n,o,s,u,f,d,m,a,p,g,w,S,C,_=(((De=l[0])==null?void 0:De.databasePath)||"Not specified")+"",y,P,D,$,B=(((x=(Ee=l[0])==null?void 0:Ee.csvFiles)==null?void 0:x.length)||0)+"",re,W,I,H,A,z,M,K,R,N=(l[2]||JSON.stringify(l[0],null,2))+"",le,pe,se,ae,J,oe,we,ve;function qe(te,O){var X;return(X=te[0])!=null&&X.csvFiles&&te[0].csvFiles.length>0?No:Lo}let Te=qe(l),Ce=Te(l);return{c(){t=E("div"),n=E("div"),o=E("h2"),o.textContent="Configuration File Preview",s=F(),u=E("p"),f=V("File: "),d=E("code"),m=V(l[1]),a=F(),p=E("div"),g=E("h3"),g.textContent="Database Path:",w=F(),S=E("div"),C=E("code"),y=V(_),P=F(),D=E("h3"),$=V("CSV Files ("),re=V(B),W=V("):"),I=F(),H=E("div"),Ce.c(),A=F(),z=E("div"),M=E("h3"),M.textContent="Raw File Content:",K=F(),R=E("pre"),le=V(N),pe=F(),se=E("div"),ae=E("button"),ae.textContent="Cancel",J=F(),oe=E("button"),oe.textContent="Proceed with Loading",v(o,"class","svelte-fu6li4"),v(d,"class","svelte-fu6li4"),v(u,"class","config-path svelte-fu6li4"),v(g,"class","svelte-fu6li4"),v(C,"class","svelte-fu6li4"),v(S,"class","config-value svelte-fu6li4"),v(D,"class","svelte-fu6li4"),v(H,"class","csv-files-list svelte-fu6li4"),v(M,"class","svelte-fu6li4"),v(R,"class","svelte-fu6li4"),v(z,"class","raw-json svelte-fu6li4"),v(p,"class","config-display svelte-fu6li4"),v(ae,"class","button secondary svelte-fu6li4"),v(oe,"class","button primary svelte-fu6li4"),v(se,"class","actions svelte-fu6li4"),v(n,"class","preview-content svelte-fu6li4"),v(t,"class","config-preview svelte-fu6li4")},m(te,O){Q(te,t,O),h(t,n),h(n,o),h(n,s),h(n,u),h(u,f),h(u,d),h(d,m),h(n,a),h(n,p),h(p,g),h(p,w),h(p,S),h(S,C),h(C,y),h(p,P),h(p,D),h(D,$),h(D,re),h(D,W),h(p,I),h(p,H),Ce.m(H,null),h(p,A),h(p,z),h(z,M),h(z,K),h(z,R),h(R,le),h(n,pe),h(n,se),h(se,ae),h(se,J),h(se,oe),we||(ve=[me(ae,"click",l[4]),me(oe,"click",l[3])],we=!0)},p(te,[O]){var X,ne,Se;O&2&&fe(m,te[1]),O&1&&_!==(_=(((X=te[0])==null?void 0:X.databasePath)||"Not specified")+"")&&fe(y,_),O&1&&B!==(B=(((Se=(ne=te[0])==null?void 0:ne.csvFiles)==null?void 0:Se.length)||0)+"")&&fe(re,B),Te===(Te=qe(te))&&Ce?Ce.p(te,O):(Ce.d(1),Ce=Te(te),Ce&&(Ce.c(),Ce.m(H,null))),O&5&&N!==(N=(te[2]||JSON.stringify(te[0],null,2))+"")&&fe(le,N)},i:ge,o:ge,d(te){te&&U(t),Ce.d(),we=!1,Me(ve)}}}function Mo(l,t,n){let{config:o=null}=t,{configPath:s=""}=t,{configManager:u=null}=t;const f=yt();let d="";Qr(async()=>{if(u&&s)try{n(2,d=await u.readConfigFileRaw(s)||"")}catch(p){console.error("Error reading raw config:",p),n(2,d=JSON.stringify(o,null,2))}else n(2,d=JSON.stringify(o,null,2))});function m(){f("proceed")}function a(){f("cancel")}return l.$$set=p=>{"config"in p&&n(0,o=p.config),"configPath"in p&&n(1,s=p.configPath),"configManager"in p&&n(5,u=p.configManager)},[o,s,d,m,a,u]}class Do extends nt{constructor(t){super(),tt(this,t,Mo,Ro,$e,{config:0,configPath:1,configManager:5})}}function Tr(l,t,n){const o=l.slice();return o[12]=t[n],o}function Io(l){let t,n,o,s,u,f,d,m,a,p,g=l[0].length+"",w,S,C,_,y,P,D,$,B,re,W=l[2]?"Deleting...":`Delete Selected (${l[1].size})`,I,H,A,z,M=Pe(l[0]),K=[];for(let R=0;R<M.length;R+=1)K[R]=Sr(Tr(l,M,R));return{c(){t=E("p"),t.textContent="The following tables already exist in the database. Select the tables you want to delete before loading new CSV files.",n=F(),o=E("div"),s=E("div"),u=E("label"),f=E("input"),d=F(),m=E("span"),a=E("strong"),p=V("Select All ("),w=V(g),S=V(" tables)"),C=F(),_=E("div");for(let R=0;R<K.length;R+=1)K[R].c();y=F(),P=E("div"),D=E("button"),$=V("Skip (Keep All Tables)"),B=F(),re=E("button"),I=V(W),v(t,"class","info-text svelte-byhfly"),v(f,"type","checkbox"),f.checked=l[3],v(f,"class","svelte-byhfly"),v(u,"class","checkbox-label svelte-byhfly"),v(s,"class","select-all-container svelte-byhfly"),v(_,"class","table-list svelte-byhfly"),v(o,"class","table-list-container svelte-byhfly"),v(D,"class","button secondary svelte-byhfly"),D.disabled=l[2],v(re,"class","button danger svelte-byhfly"),re.disabled=H=l[2]||!l[4],v(P,"class","actions svelte-byhfly")},m(R,N){Q(R,t,N),Q(R,n,N),Q(R,o,N),h(o,s),h(s,u),h(u,f),h(u,d),h(u,m),h(m,a),h(a,p),h(a,w),h(a,S),h(o,C),h(o,_);for(let le=0;le<K.length;le+=1)K[le]&&K[le].m(_,null);Q(R,y,N),Q(R,P,N),h(P,D),h(D,$),h(P,B),h(P,re),h(re,I),A||(z=[me(f,"change",l[6]),me(D,"click",l[8]),me(re,"click",l[7])],A=!0)},p(R,N){if(N&8&&(f.checked=R[3]),N&1&&g!==(g=R[0].length+"")&&fe(w,g),N&35){M=Pe(R[0]);let le;for(le=0;le<M.length;le+=1){const pe=Tr(R,M,le);K[le]?K[le].p(pe,N):(K[le]=Sr(pe),K[le].c(),K[le].m(_,null))}for(;le<K.length;le+=1)K[le].d(1);K.length=M.length}N&4&&(D.disabled=R[2]),N&6&&W!==(W=R[2]?"Deleting...":`Delete Selected (${R[1].size})`)&&fe(I,W),N&20&&H!==(H=R[2]||!R[4])&&(re.disabled=H)},d(R){R&&(U(t),U(n),U(o),U(y),U(P)),ft(K,R),A=!1,Me(z)}}}function Oo(l){let t,n,o,s,u,f;return{c(){t=E("div"),n=E("p"),n.textContent="No existing tables found in the database.",o=F(),s=E("button"),s.textContent="Proceed to Load CSV Files",v(n,"class","svelte-byhfly"),v(s,"class","button primary svelte-byhfly"),v(t,"class","no-tables svelte-byhfly")},m(d,m){Q(d,t,m),h(t,n),h(t,o),h(t,s),u||(f=me(s,"click",l[8]),u=!0)},p:ge,d(d){d&&U(t),u=!1,f()}}}function Sr(l){let t,n,o,s,u,f,d=l[12]+"",m,a,p,g;function w(){return l[10](l[12])}return{c(){t=E("div"),n=E("label"),o=E("input"),u=F(),f=E("span"),m=V(d),a=F(),v(o,"type","checkbox"),o.checked=s=l[1].has(l[12]),v(o,"class","svelte-byhfly"),v(f,"class","table-name svelte-byhfly"),v(n,"class","checkbox-label svelte-byhfly"),v(t,"class","table-item svelte-byhfly")},m(S,C){Q(S,t,C),h(t,n),h(n,o),h(n,u),h(n,f),h(f,m),h(t,a),p||(g=me(o,"change",w),p=!0)},p(S,C){l=S,C&3&&s!==(s=l[1].has(l[12]))&&(o.checked=s),C&1&&d!==(d=l[12]+"")&&fe(m,d)},d(S){S&&U(t),p=!1,g()}}}function Fo(l){let t,n,o,s;function u(m,a){return m[0].length===0?Oo:Io}let f=u(l),d=f(l);return{c(){t=E("div"),n=E("div"),o=E("h2"),o.textContent="Existing Database Tables",s=F(),d.c(),v(o,"class","svelte-byhfly"),v(n,"class","manager-content svelte-byhfly"),v(t,"class","table-manager svelte-byhfly")},m(m,a){Q(m,t,a),h(t,n),h(n,o),h(n,s),d.m(n,null)},p(m,[a]){f===(f=u(m))&&d?d.p(m,a):(d.d(1),d=f(m),d&&(d.c(),d.m(n,null)))},i:ge,o:ge,d(m){m&&U(t),d.d()}}}function zo(l,t,n){let o,s,{tables:u=[]}=t,{dbManager:f=null}=t;const d=yt();let m=!1,a=new Set;function p(_){a.has(_)?a.delete(_):a.add(_),n(1,a)}function g(){a.size===u.length?a.clear():n(1,a=new Set(u)),n(1,a)}async function w(){if(a.size===0){d("proceed");return}n(2,m=!0);try{for(const _ of a)f&&f.db&&f.db.run(`DROP TABLE IF EXISTS "${_}"`);d("tablesDeleted")}catch(_){console.error("Error deleting tables:",_)}finally{n(2,m=!1)}}function S(){d("proceed")}const C=_=>p(_);return l.$$set=_=>{"tables"in _&&n(0,u=_.tables),"dbManager"in _&&n(9,f=_.dbManager)},l.$$.update=()=>{l.$$.dirty&2&&n(4,o=a.size>0),l.$$.dirty&3&&n(3,s=u.length>0&&a.size===u.length)},[u,a,m,s,o,p,g,w,S,f,C]}class jo extends nt{constructor(t){super(),tt(this,t,zo,Fo,$e,{tables:0,dbManager:9})}}function Cr(l,t,n){const o=l.slice();return o[8]=t[n],o[10]=n,o}function qr(l){let t,n,o,s,u,f,d;return{c(){t=E("div"),n=E("pre"),o=V(l[1]),s=F(),u=E("button"),u.textContent="",v(n,"class","svelte-115fefa"),v(u,"class","svelte-115fefa"),v(t,"class","error-banner svelte-115fefa")},m(m,a){Q(m,t,a),h(t,n),h(n,o),h(t,s),h(t,u),f||(d=me(u,"click",l[4]),f=!0)},p(m,a){a&2&&fe(o,m[1])},d(m){m&&U(t),f=!1,d()}}}function Vo(l){let t=[],n=new Map,o,s=Pe(l[0]);const u=f=>f[10];for(let f=0;f<s.length;f+=1){let d=Cr(l,s,f),m=u(d);n.set(m,t[f]=Mr(m,d))}return{c(){for(let f=0;f<t.length;f+=1)t[f].c();o=gn()},m(f,d){for(let m=0;m<t.length;m+=1)t[m]&&t[m].m(f,d);Q(f,o,d)},p(f,d){d&1&&(s=Pe(f[0]),t=Yl(t,d,u,1,f,s,n,o.parentNode,Jl,Mr,o,Cr))},d(f){f&&U(o);for(let d=0;d<t.length;d+=1)t[d].d(f)}}}function Uo(l){let t;return{c(){t=E("div"),t.textContent="No log entries yet. Execute some commands to see them here.",v(t,"class","empty-message svelte-115fefa")},m(n,o){Q(n,t,o)},p:ge,d(n){n&&U(t)}}}function Ar(l){let t;return{c(){t=E("span"),t.textContent="ERROR",v(t,"class","error-badge svelte-115fefa")},m(n,o){Q(n,t,o)},d(n){n&&U(t)}}}function Pr(l){let t,n,o,s=l[8].naturalLanguage+"",u;return{c(){t=E("div"),n=E("strong"),n.textContent="NL:",o=F(),u=V(s),v(n,"class","svelte-115fefa"),v(t,"class","entry-line svelte-115fefa")},m(f,d){Q(f,t,d),h(t,n),h(t,o),h(t,u)},p(f,d){d&1&&s!==(s=f[8].naturalLanguage+"")&&fe(u,s)},d(f){f&&U(t)}}}function Lr(l){let t,n,o,s,u=l[8].sql+"",f;return{c(){t=E("div"),n=E("strong"),n.textContent="SQL:",o=F(),s=E("code"),f=V(u),v(n,"class","svelte-115fefa"),v(s,"class","svelte-115fefa"),v(t,"class","entry-line svelte-115fefa")},m(d,m){Q(d,t,m),h(t,n),h(t,o),h(t,s),h(s,f)},p(d,m){m&1&&u!==(u=d[8].sql+"")&&fe(f,u)},d(d){d&&U(t)}}}function Nr(l){let t,n,o,s=l[8].error+"",u;return{c(){t=E("div"),n=E("strong"),n.textContent="ERROR:",o=F(),u=V(s),v(n,"class","svelte-115fefa"),v(t,"class","entry-line error svelte-115fefa")},m(f,d){Q(f,t,d),h(t,n),h(t,o),h(t,u)},p(f,d){d&1&&s!==(s=f[8].error+"")&&fe(u,s)},d(f){f&&U(t)}}}function Rr(l){let t,n,o,s=l[8].result+"",u;return{c(){t=E("div"),n=E("strong"),n.textContent="RESULT:",o=F(),u=V(s),v(n,"class","svelte-115fefa"),v(t,"class","entry-line result svelte-115fefa")},m(f,d){Q(f,t,d),h(t,n),h(t,o),h(t,u)},p(f,d){d&1&&s!==(s=f[8].result+"")&&fe(u,s)},d(f){f&&U(t)}}}function Mr(l,t){let n,o,s,u,f=t[8].timestamp+"",d,m,a,p,g,w,S,C,_,y=t[8].error&&Ar(),P=t[8].naturalLanguage&&Pr(t),D=t[8].sql&&Lr(t),$=t[8].error&&Nr(t),B=t[8].result&&Rr(t);return{key:l,first:null,c(){n=E("div"),o=E("div"),s=E("span"),u=V("["),d=V(f),m=V("]"),a=F(),y&&y.c(),p=F(),P&&P.c(),g=F(),D&&D.c(),w=F(),$&&$.c(),S=F(),B&&B.c(),C=F(),v(s,"class","timestamp svelte-115fefa"),v(o,"class","entry-header svelte-115fefa"),v(n,"class",_="log-entry "+(t[8].error?"has-error":"")+" svelte-115fefa"),this.first=n},m(re,W){Q(re,n,W),h(n,o),h(o,s),h(s,u),h(s,d),h(s,m),h(o,a),y&&y.m(o,null),h(n,p),P&&P.m(n,null),h(n,g),D&&D.m(n,null),h(n,w),$&&$.m(n,null),h(n,S),B&&B.m(n,null),h(n,C)},p(re,W){t=re,W&1&&f!==(f=t[8].timestamp+"")&&fe(d,f),t[8].error?y||(y=Ar(),y.c(),y.m(o,null)):y&&(y.d(1),y=null),t[8].naturalLanguage?P?P.p(t,W):(P=Pr(t),P.c(),P.m(n,g)):P&&(P.d(1),P=null),t[8].sql?D?D.p(t,W):(D=Lr(t),D.c(),D.m(n,w)):D&&(D.d(1),D=null),t[8].error?$?$.p(t,W):($=Nr(t),$.c(),$.m(n,S)):$&&($.d(1),$=null),t[8].result?B?B.p(t,W):(B=Rr(t),B.c(),B.m(n,C)):B&&(B.d(1),B=null),W&1&&_!==(_="log-entry "+(t[8].error?"has-error":"")+" svelte-115fefa")&&v(n,"class",_)},d(re){re&&U(n),y&&y.d(),P&&P.d(),D&&D.d(),$&&$.d(),B&&B.d()}}}function Qo(l){let t,n,o,s,u,f,d,m,a,p,g,w,S=l[1]&&qr(l);function C(P,D){return P[0].length===0?Uo:Vo}let _=C(l),y=_(l);return{c(){t=E("div"),n=E("header"),o=E("h2"),o.textContent="SQL Command Log",s=F(),u=E("div"),f=E("button"),f.textContent="Refresh",d=F(),S&&S.c(),m=F(),a=E("div"),p=E("div"),y.c(),v(o,"class","svelte-115fefa"),v(f,"class","button refresh svelte-115fefa"),v(u,"class","header-actions svelte-115fefa"),v(n,"class","log-header svelte-115fefa"),v(p,"class","log-display svelte-115fefa"),v(a,"class","log-content svelte-115fefa"),v(t,"class","log-viewer svelte-115fefa")},m(P,D){Q(P,t,D),h(t,n),h(n,o),h(n,s),h(n,u),h(u,f),h(t,d),S&&S.m(t,null),h(t,m),h(t,a),h(a,p),y.m(p,null),g||(w=me(f,"click",l[2]),g=!0)},p(P,[D]){P[1]?S?S.p(P,D):(S=qr(P),S.c(),S.m(t,m)):S&&(S.d(1),S=null),_===(_=C(P))&&y?y.p(P,D):(y.d(1),y=_(P),y&&(y.c(),y.m(p,null)))},i:ge,o:ge,d(P){P&&U(t),S&&S.d(),y.d(),g=!1,w()}}}function Bo(l,t,n){let{logManager:o=null}=t;yt();let s="",u=[],f="";async function d(){if(o)try{s=await o.loadLog(),m()}catch(p){console.error("Error loading log:",p),n(1,f=`Error loading log: ${p.message}`)}}function m(){o&&n(0,u=o.parseLogEntries(s))}const a=()=>n(1,f="");return l.$$set=p=>{"logManager"in p&&n(3,o=p.logManager)},l.$$.update=()=>{l.$$.dirty&8&&o&&d()},[u,f,d,o,a]}class Wo extends nt{constructor(t){super(),tt(this,t,Bo,Qo,$e,{logManager:3})}}const{window:Go}=Ol;function Dr(l){let t,n,o;return{c(){t=E("div"),n=V("Version "),o=V(l[13]),v(t,"class","version-banner svelte-7zqrgv")},m(s,u){Q(s,t,u),h(t,n),h(t,o)},p(s,u){u[0]&8192&&fe(o,s[13])},d(s){s&&U(t)}}}function Ir(l){let t,n,o,s=l[14].connected?"":"",u,f,d,m=l[14].message+"",a,p,g,w,S,C,_,y=l[14].suggestion&&Or(l);return{c(){t=E("div"),n=E("div"),o=E("span"),u=V(s),f=F(),d=E("span"),a=V(m),p=F(),y&&y.c(),g=F(),w=E("button"),w.textContent="",v(o,"class","llm-status-icon svelte-7zqrgv"),v(d,"class","llm-status-message svelte-7zqrgv"),v(n,"class","llm-status-content svelte-7zqrgv"),v(w,"class","llm-status-close svelte-7zqrgv"),v(w,"title","Dismiss"),v(t,"class",S="llm-status-banner "+(l[14].connected?"connected":"disconnected")+" svelte-7zqrgv")},m(P,D){Q(P,t,D),h(t,n),h(n,o),h(o,u),h(n,f),h(n,d),h(d,a),h(n,p),y&&y.m(n,null),h(t,g),h(t,w),C||(_=me(w,"click",l[33]),C=!0)},p(P,D){D[0]&16384&&s!==(s=P[14].connected?"":"")&&fe(u,s),D[0]&16384&&m!==(m=P[14].message+"")&&fe(a,m),P[14].suggestion?y?y.p(P,D):(y=Or(P),y.c(),y.m(n,null)):y&&(y.d(1),y=null),D[0]&16384&&S!==(S="llm-status-banner "+(P[14].connected?"connected":"disconnected")+" svelte-7zqrgv")&&v(t,"class",S)},d(P){P&&U(t),y&&y.d(),C=!1,_()}}}function Or(l){let t,n,o=l[14].suggestion+"",s,u;return{c(){t=E("span"),n=V("("),s=V(o),u=V(")"),v(t,"class","llm-status-suggestion svelte-7zqrgv")},m(f,d){Q(f,t,d),h(t,n),h(t,s),h(t,u)},p(f,d){d[0]&16384&&o!==(o=f[14].suggestion+"")&&fe(s,o)},d(f){f&&U(t)}}}function Fr(l){let t,n,o,s,u,f;return{c(){t=E("div"),n=V(l[12]),o=F(),s=E("button"),s.textContent="",v(s,"class","svelte-7zqrgv"),v(t,"class","error-banner svelte-7zqrgv")},m(d,m){Q(d,t,m),h(t,n),h(t,o),h(t,s),u||(f=me(s,"click",l[34]),u=!0)},p(d,m){m[0]&4096&&fe(n,d[12])},d(d){d&&U(t),u=!1,f()}}}function Ho(l){let t,n,o,s,u,f,d,m,a,p;return d=new Wo({props:{logManager:l[5]}}),d.$on("refresh",l[25]),{c(){t=E("div"),n=E("div"),o=E("button"),o.textContent="Table View",s=F(),u=E("button"),u.textContent="Log View",f=F(),dt(d.$$.fragment),v(o,"class","toggle-button svelte-7zqrgv"),v(u,"class","toggle-button active svelte-7zqrgv"),v(n,"class","view-toggle svelte-7zqrgv"),v(t,"class","viewer-container svelte-7zqrgv")},m(g,w){Q(g,t,w),h(t,n),h(n,o),h(n,s),h(n,u),h(t,f),xe(d,t,null),m=!0,a||(p=me(o,"click",l[28]),a=!0)},p(g,w){const S={};w[0]&32&&(S.logManager=g[5]),d.$set(S)},i(g){m||(Ae(d.$$.fragment,g),m=!0)},o(g){Oe(d.$$.fragment,g),m=!1},d(g){g&&U(t),et(d),a=!1,p()}}}function Xo(l){let t,n,o,s,u,f,d,m,a,p,g,w=l[2]&&window.electronAPI&&zr(l);return m=new Co({props:{tables:l[8],currentTable:l[2],dbManager:l[0],tableToCsvMap:l[9],electronAPI:window.electronAPI,modifiedTables:l[10]}}),m.$on("tableSelect",l[24]),m.$on("refresh",l[25]),m.$on("tableModified",l[26]),m.$on("updateAndRestart",l[27]),{c(){t=E("div"),n=E("div"),o=E("button"),o.textContent="Table View",s=F(),u=E("button"),u.textContent="Log View",f=F(),w&&w.c(),d=F(),dt(m.$$.fragment),v(o,"class","toggle-button active svelte-7zqrgv"),v(u,"class","toggle-button svelte-7zqrgv"),v(n,"class","view-toggle svelte-7zqrgv"),v(t,"class","viewer-container svelte-7zqrgv")},m(S,C){Q(S,t,C),h(t,n),h(n,o),h(n,s),h(n,u),h(t,f),w&&w.m(t,null),h(t,d),xe(m,t,null),a=!0,p||(g=me(u,"click",l[28]),p=!0)},p(S,C){S[2]&&window.electronAPI?w?w.p(S,C):(w=zr(S),w.c(),w.m(t,d)):w&&(w.d(1),w=null);const _={};C[0]&256&&(_.tables=S[8]),C[0]&4&&(_.currentTable=S[2]),C[0]&1&&(_.dbManager=S[0]),C[0]&512&&(_.tableToCsvMap=S[9]),C[0]&1024&&(_.modifiedTables=S[10]),m.$set(_)},i(S){a||(Ae(m.$$.fragment,S),a=!0)},o(S){Oe(m.$$.fragment,S),a=!1},d(S){S&&U(t),w&&w.d(),et(m),p=!1,g()}}}function Jo(l){let t,n;return t=new Po({props:{message:l[11]}}),{c(){dt(t.$$.fragment)},m(o,s){xe(t,o,s),n=!0},p(o,s){const u={};s[0]&2048&&(u.message=o[11]),t.$set(u)},i(o){n||(Ae(t.$$.fragment,o),n=!0)},o(o){Oe(t.$$.fragment,o),n=!1},d(o){et(t,o)}}}function Yo(l){let t,n;return t=new Do({props:{config:l[6],configPath:l[7],configManager:l[4]}}),t.$on("proceed",l[22]),t.$on("cancel",l[23]),{c(){dt(t.$$.fragment)},m(o,s){xe(t,o,s),n=!0},p(o,s){const u={};s[0]&64&&(u.config=o[6]),s[0]&128&&(u.configPath=o[7]),s[0]&16&&(u.configManager=o[4]),t.$set(u)},i(o){n||(Ae(t.$$.fragment,o),n=!0)},o(o){Oe(t.$$.fragment,o),n=!1},d(o){et(t,o)}}}function Ko(l){let t,n;return t=new jo({props:{tables:l[8],dbManager:l[0]}}),t.$on("tablesDeleted",l[21]),t.$on("proceed",l[22]),{c(){dt(t.$$.fragment)},m(o,s){xe(t,o,s),n=!0},p(o,s){const u={};s[0]&256&&(u.tables=o[8]),s[0]&1&&(u.dbManager=o[0]),t.$set(u)},i(o){n||(Ae(t.$$.fragment,o),n=!0)},o(o){Oe(t.$$.fragment,o),n=!1},d(o){et(t,o)}}}function zr(l){let t;function n(u,f){return u[17]?ei:u[20]?xo:u[3].length===0?$o:Zo}let o=n(l),s=o(l);return{c(){t=E("div"),s.c(),v(t,"class","commands-panel svelte-7zqrgv")},m(u,f){Q(u,t,f),s.m(t,null)},p(u,f){o===(o=n(u))&&s?s.p(u,f):(s.d(1),s=o(u),s&&(s.c(),s.m(t,null)))},d(u){u&&U(t),s.d()}}}function Zo(l){let t,n,o=l[3].length+"",s,u;return{c(){t=E("div"),n=V("All commands completed ("),s=V(o),u=V(" total)"),v(t,"class","commands-complete svelte-7zqrgv")},m(f,d){Q(f,t,d),h(t,n),h(t,s),h(t,u)},p(f,d){d[0]&8&&o!==(o=f[3].length+"")&&fe(s,o)},d(f){f&&U(t)}}}function $o(l){let t;return{c(){t=E("div"),t.textContent="No commands loaded. Create a commands.txt file in the application directory.",v(t,"class","commands-info svelte-7zqrgv")},m(n,o){Q(n,t,o)},p:ge,d(n){n&&U(t)}}}function xo(l){let t,n,o,s,u,f,d,m,a,p,g=l[16]?"Executing...":"Execute Next Command",w,S,C;return{c(){t=E("div"),n=E("div"),o=V("Next Command ("),s=V(l[19]),u=V("):"),f=F(),d=E("div"),m=V(l[18]),a=F(),p=E("button"),w=V(g),v(n,"class","command-label svelte-7zqrgv"),v(d,"class","command-text svelte-7zqrgv"),v(p,"class","execute-next-button svelte-7zqrgv"),p.disabled=l[16],v(p,"title","Execute this command"),v(t,"class","next-command-display svelte-7zqrgv")},m(_,y){Q(_,t,y),h(t,n),h(n,o),h(n,s),h(n,u),h(t,f),h(t,d),h(d,m),h(t,a),h(t,p),h(p,w),S||(C=me(p,"click",l[29]),S=!0)},p(_,y){y[0]&524288&&fe(s,_[19]),y[0]&262144&&fe(m,_[18]),y[0]&65536&&g!==(g=_[16]?"Executing...":"Execute Next Command")&&fe(w,g),y[0]&65536&&(p.disabled=_[16])},d(_){_&&U(t),S=!1,C()}}}function ei(l){let t,n;return{c(){t=E("div"),n=V(l[17]),v(t,"class","commands-error svelte-7zqrgv")},m(o,s){Q(o,t,s),h(t,n)},p(o,s){s[0]&131072&&fe(n,o[17])},d(o){o&&U(t)}}}function ti(l){let t,n,o,s,u,f,d,m,a,p=l[13]&&Dr(l),g=l[15]&&l[14]&&Ir(l),w=l[12]&&Fr(l);const S=[Ko,Yo,Jo,Xo,Ho],C=[];function _(y,P){return y[1]==="tableManager"?0:y[1]==="configPreview"?1:y[1]==="loading"?2:y[1]==="viewer"?3:y[1]==="logView"?4:-1}return~(u=_(l))&&(f=C[u]=S[u](l)),{c(){t=E("div"),p&&p.c(),n=F(),g&&g.c(),o=F(),w&&w.c(),s=F(),f&&f.c(),v(t,"class","app svelte-7zqrgv")},m(y,P){Q(y,t,P),p&&p.m(t,null),h(t,n),g&&g.m(t,null),h(t,o),w&&w.m(t,null),h(t,s),~u&&C[u].m(t,null),d=!0,m||(a=me(Go,"beforeunload",l[32]),m=!0)},p(y,P){y[13]?p?p.p(y,P):(p=Dr(y),p.c(),p.m(t,n)):p&&(p.d(1),p=null),y[15]&&y[14]?g?g.p(y,P):(g=Ir(y),g.c(),g.m(t,o)):g&&(g.d(1),g=null),y[12]?w?w.p(y,P):(w=Fr(y),w.c(),w.m(t,s)):w&&(w.d(1),w=null);let D=u;u=_(y),u===D?~u&&C[u].p(y,P):(f&&(mn(),Oe(C[D],1,1,()=>{C[D]=null}),pn()),~u?(f=C[u],f?f.p(y,P):(f=C[u]=S[u](y),f.c()),Ae(f,1),f.m(t,null)):f=null)},i(y){d||(Ae(f),d=!0)},o(y){Oe(f),d=!1},d(y){y&&U(t),p&&p.d(),g&&g.d(),w&&w.d(),~u&&C[u].d(),m=!1,a()}}}function ni(l,t,n){let o,s,u,f,d,m,a="loading",p=null,g=null,w=[],S={},C=new Set,_=null,y="",P="",D="",$=null,B=!0;Qr(async()=>{if(window.addEventListener("llm-status",x=>{n(14,$=x.detail),console.log("LLM Status:",$)}),console.log("App mounted, checking for electronAPI..."),console.log("window.electronAPI:",window.electronAPI),setTimeout(async()=>{if(!$&&window.electronAPI&&window.electronAPI.testOllamaConnection)try{const x=await window.electronAPI.testOllamaConnection();n(14,$={connected:x.success,message:x.success?"Ollama connected successfully":`Ollama not available: ${x.error||x.message||"Connection failed"}`,host:x.host||"localhost",port:x.port||"11434",error:x.error,suggestion:x.suggestion})}catch(x){n(14,$={connected:!1,message:`Failed to test Ollama connection: ${x.message}`})}},1e3),window.electronAPI)try{window.electronAPI.getAppVersion&&(n(13,D=await window.electronAPI.getAppVersion()),console.log(`Application version: ${D}`)),n(4,f=new $l(window.electronAPI)),await f.initialize(),n(0,d=new oo),await d.initialize(),n(5,m=new io(window.electronAPI)),await m.initialize(),console.log("Initialization complete"),await re()}catch(x){console.error("Initialization error:",x),n(12,P=`Initialization error: ${x.message}`)}else console.error("Electron API not available"),n(12,P="Electron API not available. Please run this application in Electron.")});async function re(){try{if(n(11,y="Initializing..."),n(7,g=f.getDefaultConfigPath()),n(6,p=await f.loadConfig(g)),p||(await f.createDefaultConfig(),n(6,p=await f.loadConfig(g))),!p||!f.validateConfig(p)){n(12,P="Invalid configuration file");return}n(11,y="Creating fresh database...");try{await window.electronAPI.deleteDatabase(p.databasePath),console.log("Previous database deleted (if it existed)")}catch(x){console.warn("Error deleting database (may not exist):",x)}d.createNew(),console.log("Fresh database created"),n(1,a="loading"),await H()}catch(x){n(12,P=`Error loading config: ${x.message}`),console.error(x)}}async function W(){d&&p&&await d.saveToFile(p.databasePath,window.electronAPI),d&&n(8,w=d.getTableNames()),I()}function I(){n(1,a="loading"),H()}async function H(){if(!p||!p.csvFiles||p.csvFiles.length===0){n(8,w=d.getTableNames()),w.length>0&&n(2,_=w[0]),n(1,a="viewer"),n(11,y=""),w.length>0&&(console.log("No CSV files to load, starting automatic command execution..."),setTimeout(async()=>{await Te()},200));return}n(11,y="Loading CSV files..."),n(9,S={});let x=0;for(let te=0;te<p.csvFiles.length;te++){const O=p.csvFiles[te],X=nr.getTableNameFromPath(O);n(11,y=`Loading ${O}... (${te+1}/${p.csvFiles.length})`);try{const ne=await window.electronAPI.readCsvFile(O),{schema:Se,data:je}=nr.parseCSV(ne);n(9,S[X]=O,S),d.createTable(X,Se),d.insertData(X,Se,je),x++}catch(ne){console.error(`Error loading CSV file ${O}:`,ne),n(12,P=`Error loading ${O}: ${ne.message}`)}}x>0&&(n(11,y="Saving database..."),await d.saveToFile(p.databasePath,window.electronAPI)),n(8,w=d.getTableNames()),w.length>0&&(n(2,_=w[0]),M()),n(1,a="viewer"),n(11,y=""),!P&&w.length>0&&(console.log("CSV files loaded successfully, starting automatic command execution..."),setTimeout(async()=>{await Te()},200))}function A(){n(1,a="startup"),n(6,p=null),n(7,g=null)}function z(x){var O;const te=(O=x.detail)==null?void 0:O.table;te&&(n(2,_=te),M())}function M(){d&&_&&d.getTableSchema(_)}function K(){d&&(n(8,w=d.getTableNames()),w.length>0&&!w.includes(_)?(n(2,_=w[0]),M()):_&&M())}function R(x){var O;const te=(O=x.detail)==null?void 0:O.table;te&&S[te]&&(C.add(te),n(10,C),console.log(`Table "${te}" marked as modified`))}async function N(){if(C.size===0){alert("No tables have been modified. Nothing to save.");return}const te=`The following tables have been modified:
${Array.from(C).join(", ")}

This will overwrite the original CSV files and restart the application.

Continue?`;if(confirm(te))try{for(const O of C){const X=S[O];if(!X){console.warn(`No CSV path found for table "${O}", skipping`);continue}const ne=d.getTableSchema(O);if(!ne||ne.length===0){console.warn(`Unable to get schema for table "${O}", skipping`);continue}const Se=d.getAllTableData(O);if(!Se){console.warn(`Unable to retrieve data for table "${O}", skipping`);continue}const je=bn.exportTableToCSV(O,ne,Se);await window.electronAPI.writeCsvFile(X,je),console.log(`Table "${O}" exported to ${X}`)}if(p&&p.databasePath)try{await window.electronAPI.deleteDatabase(p.databasePath),console.log("Database deleted before restart")}catch(O){console.warn("Error deleting database before restart:",O)}await window.electronAPI.restartApp()}catch(O){console.error("Error updating CSV files:",O),alert(`Error updating CSV files: ${O.message}`)}}function le(){a==="viewer"?n(1,a="logView"):a==="logView"&&n(1,a="viewer")}async function pe(x){const te=x.detail;if(!m)return;const O=m.formatLogEntry(te),X=await m.loadLog(),ne=X+(X?`
`:"")+O;await m.saveLog(ne)}let se=[],ae=0,J=!1,oe=null,we=!1;async function ve(){if(!window.electronAPI){n(3,se=[]),n(17,oe="Electron API not available"),n(31,we=!1);return}try{const te=(await window.electronAPI.readCommandsFile()).split(`
`).map(O=>O.trim()).filter(O=>O.length>0&&!O.startsWith("#")&&!O.startsWith("[")&&!O.startsWith("!REM"));n(3,se=te),n(17,oe=null),n(31,we=!0),ae>=se.length&&n(30,ae=se.length),se.length===0&&n(17,oe="No commands found in commands.txt (empty file or only comments)")}catch(x){console.error("Error loading commands:",x),n(3,se=[]),n(17,oe=`Error reading commands.txt: ${x.message}`),n(31,we=!1)}}async function qe(){var x;if(!window.electronAPI||!d||!_)return n(12,P="Electron API, database, or table not available"),!1;if(J||!o)return!1;n(16,J=!0),n(12,P=""),n(17,oe=null);try{let te=d.getTableSchema(_);if(!te||te.length===0)return n(12,P="Unable to get table schema"),n(16,J=!1),!1;const O=o;if(console.log(`Processing command ${ae+1}/${se.length}: ${O}`),O.startsWith("!SAVE"))try{const ye=O.split(/\s+/);if(ye.length<3)throw new Error("!SAVE command requires format: !SAVE <tableName> <filePath>");const ce=ye[1],Qe=ye.slice(2).join(" ");if(!d.getTableNames().includes(ce))throw new Error(`Table "${ce}" does not exist`);const rt=d.getTableSchema(ce);if(!rt||rt.length===0)throw new Error(`Unable to get schema for table "${ce}"`);const lt=d.getAllTableData(ce),ht=bn.exportTableToCSV(ce,rt,lt);await window.electronAPI.writeCsvFile(Qe,ht);const Gt=((x=lt==null?void 0:lt.rows)==null?void 0:x.length)||0,Et=`Exported table "${ce}" (${Gt} row(s)) to ${Qe}`;console.log(Et);const Ht=new Date().toISOString().replace("T"," ").substring(0,19);return await pe({detail:{naturalLanguage:O,sql:null,error:null,result:Et,timestamp:Ht}}),n(30,ae=ae+1),console.log(`Command ${ae}/${se.length} completed, moving to next`),!0}catch(ye){const ce=ye.message||"Failed to save table";console.error(`Error executing !SAVE command ${ae+1}:`,ce);const Qe=new Date().toISOString().replace("T"," ").substring(0,19);return await pe({detail:{naturalLanguage:O,sql:null,error:ce,result:null,timestamp:Qe}}),n(12,P=`Error executing !SAVE command ${ae+1} ("${O}"): ${ce}`),n(16,J=!1),!1}let X=null;try{const ye=await window.electronAPI.getSqlForCommand(O);ye&&ye.trim()!==""&&(X=ye.trim(),console.log(`Using existing SQL for command: ${X}`))}catch(ye){console.warn("Error checking for existing SQL:",ye)}if(!X)try{if(X=await window.electronAPI.translateToSQL(O,_,te),!X||X.trim()==="")throw new Error("Empty SQL returned from translation");console.log(`Generated new SQL for command: ${X}`)}catch(ye){const ce=ye.message;console.error(`Error translating command ${ae+1}:`,ce);const Qe=new Date().toISOString().replace("T"," ").substring(0,19);return await pe({detail:{naturalLanguage:O,sql:null,error:ce,result:null,timestamp:Qe}}),n(12,P=`Error translating command ${ae+1} ("${O}"): ${ce}`),n(16,J=!1),!1}let ne=null,Se=null;try{ne=d.executeSQL(X),p&&ne.type==="modify"&&(await d.saveToFile(p.databasePath,window.electronAPI),K(),M())}catch(ye){Se=ye.message||"SQL execution failed",console.error(`Error executing command ${ae+1}:`,Se);const ce=new Date().toISOString().replace("T"," ").substring(0,19);return await pe({detail:{naturalLanguage:O,sql:X,error:Se,result:null,timestamp:ce}}),n(12,P=`Error executing command ${ae+1} ("${O}"): ${Se}`),n(16,J=!1),!1}const je=new Date().toISOString().replace("T"," ").substring(0,19);await pe({detail:{naturalLanguage:O,sql:X,error:null,result:ne?ne.type==="select"?`Returned ${ne.rowCount} row(s)`:`Affected ${ne.affectedRows} row(s)`:null,timestamp:je}});try{const ye=await window.electronAPI.getSqlForCommand(O);!ye||ye.trim()===""?(await window.electronAPI.insertSqlIntoCommandsFile(O,X),console.log(`SQL inserted into commands.txt after command: ${O}`)):console.log("SQL already exists for command, skipping insertion"),await ve()}catch(ye){console.error("Error inserting SQL into commands.txt:",ye)}return n(30,ae=ae+1),console.log(`Command ${ae}/${se.length} completed, moving to next`),!0}catch(te){return console.error("Error executing command:",te),n(12,P=`Error executing command: ${te.message}`),!1}finally{n(16,J=!1)}}async function Te(){if(!window.electronAPI||!d||!_){console.log("Cannot execute commands: prerequisites not met");return}if(we||(console.log("Waiting for commands to load..."),await ve()),await new Promise(x=>setTimeout(x,100)),se.length===0){console.log("No commands to execute");return}for(console.log(`Starting automatic execution of ${se.length} command(s)...`),n(11,y=`Executing commands... (${ae+1}/${se.length})`);ae<se.length&&!P;){if(!await qe()){console.log("Command execution stopped");break}ae<se.length?n(11,y=`Executing commands... (${ae+1}/${se.length})`):n(11,y=`All commands completed (${se.length}/${se.length})`),await new Promise(te=>setTimeout(te,50))}n(11,y=""),ae>=se.length?console.log("All commands executed successfully"):P&&console.log(`Command execution stopped due to error: ${P}`)}const Ce=()=>{d&&d.close()},De=()=>n(15,B=!1),Ee=()=>n(12,P="");return l.$$.update=()=>{l.$$.dirty[0]&1073741832&&n(18,o=ae<se.length?se[ae]:null),l.$$.dirty[0]&1073741832&&n(20,s=ae<se.length),l.$$.dirty[0]&1073741832&&n(19,u=se.length>0?`${ae+1} / ${se.length}`:"0 / 0"),l.$$.dirty[0]&6|l.$$.dirty[1]&1&&a==="viewer"&&_&&window.electronAPI&&!we&&ve(),l.$$.dirty[0]&5&&_&&d&&M()},[d,a,_,se,f,m,p,g,w,S,C,y,P,D,$,B,J,oe,o,u,s,W,I,A,z,K,R,N,le,qe,ae,we,Ce,De,Ee]}class ri extends nt{constructor(t){super(),tt(this,t,ni,ti,$e,{},null,[-1,-1])}}new ri({target:document.getElementById("app")});
